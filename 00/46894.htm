    <title>Your Windows Insider Build ran into a problem and needs to restart. - Microsoft Community</title>
<h3> mike hitchcock  say:</h3>
<h2>            Your Windows Insider Build ran into a problem and needs to restart. You can restart</h2>
                    <p>Windows insider preview. </p>
<p>Updating from 17134.5 to 17666.1001 "Working on Updates" after the 2nd restart at 75%<br />
"Stop code System thread exception not handled" <br />
"what failed kbackupdisk.sys"<br />
This failure also happened when trying to update 17134.5 to 17661.1001</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-small" role="img"
<h3> sumit &#40;volunteer moderator&#41;  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            File feedback in Feedback hub and wait for MS to fix it in the next build. Other option you have is to do a clean install.       
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=performance_and_system_failures">performance_and_system_failures, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>what default browser can i use for windows 7 - Microsoft Community</title>
<h3> liz nielsen  say:</h3>
<h2>            what default browser can i use for windows 7</h2>
                    what browser default is compatiable with windows 7
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-small circular-display" role="img"
           title="TrekDozer" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display magenta241 avatar-size-small"; this.setAttribute("alt", "TR"); this.style="display: inline-block";'
<h3> trekdozer  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            There are many browsers compatible with Windows 7. The four most popular are below:<br />
<br />
Internet Explorer - included with Windows 7<br />
Google Chrome<br />
Firefox<br />
Safari<br />
<br />
<br />
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_7">windows_7, </a> <br>
<a href="/search?q=programs">programs, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Firewall is locked down, all ports and protocols blocked, every - Microsoft Community</title>
<h3> sonya l  say:</h3>
<h2>            Firewall is locked down, all ports and protocols blocked, every program blocked</h2>
                    <p>Still having issues with this mysterious .pbk located in appdata\roaming\microsoft\network\connections.</p>
<p>
</p><p>Somehow against all odds my files have been "collected" and distributed all signs seem to point to remotefx despite the remote desktop services being disabled, despite disabling them in group policy. The computer never goes to sleep - and only has 1 user,
 however I found files modified in the defaultuser0 account. The ntuser.dat for that account references rdvvmtransport.dll several times and also contains a list of files I have created. This account is supposedly disabled but the ntuser.dat is modified daily.</p>
<p>
</p><p>Anyway a few nights ago I deleted every file named remote, ras and rdp (about 3,000 files or so) and did a new install, then locked down the windows firewall and disabled all of the services I do not use nor need... I thought it was smooth sailing until
 tonight when this .pbk reappeared. It hasn't been there for 2 days now it is and last modified at 10:45 pm.</p>
<p>
</p><p>I also set windows firewall to log everything - unfortunately it does not tell me what is causing this thing, but does give me the ip addresses. Hopefully someone can give me a suggestion that will stop this or at least tell me what "private network" these
 ip addresses belong to?</p>
<p>
</p><p>#Version: 1.5<br />
#Software: Microsoft Windows Firewall<br />
#Time Format: Local<br />
#Fields: date time action protocol src-ip dst-ip src-port dst-port size tcpflags tcpsyn tcpack tcpwin icmptype icmpcode info path<br />
<br />
2017-04-29 21:17:55 ALLOW TCP 127.0.0.1 127.0.0.1 49671 49670 0 - 0 0 0 - - - SEND<br />
2017-04-29 21:17:55 ALLOW TCP 127.0.0.1 127.0.0.1 49671 49670 0 - 0 0 0 - - - RECEIVE<br />
2017-04-29 21:17:58 ALLOW TCP 127.0.0.1 127.0.0.1 49673 49672 0 - 0 0 0 - - - SEND<br />
2017-04-29 21:17:58 ALLOW TCP 127.0.0.1 127.0.0.1 49673 49672 0 - 0 0 0 - - - RECEIVE<br />
2017-04-30 01:05:49 ALLOW TCP 127.0.0.1 127.0.0.1 49670 49669 0 - 0 0 0 - - - SEND<br />
2017-04-30 01:05:49 ALLOW TCP 127.0.0.1 127.0.0.1 49670 49669 0 - 0 0 0 - - - RECEIVE<br />
2017-04-30 01:05:52 ALLOW TCP 127.0.0.1 127.0.0.1 49672 49671 0 - 0 0 0 - - - SEND<br />
2017-04-30 01:05:52 ALLOW TCP 127.0.0.1 127.0.0.1 49672 49671 0 - 0 0 0 - - - RECEIVE<br />
2017-05-01 22:45:05 DROP 2 127.0.0.1 224.0.0.22 - - 0 - - - - - - - SEND<br />
2017-05-01 22:45:05 DROP ICMP ::1 ff02::16 - - 0 - - - - 143 0 - SEND<br />
2017-05-01 22:45:05 DROP UDP ::1 ff02::c 49665 3702 0 - - - - - - - SEND<br />
2017-05-01 22:45:05 DROP UDP 127.0.0.1 239.255.255.250 49664 3702 0 - - - - - - - SEND<br />
2017-05-01 22:45:05 DROP 2 127.0.0.1 224.0.0.22 - - 0 - - - - - - - SEND<br />
2017-05-01 22:45:05 DROP ICMP ::1 ff02::16 - - 0 - - - - 143 0 - SEND<br />
2017-05-01 22:45:05 DROP UDP 127.0.0.1 239.255.255.250 49664 3702 0 - - - - - - - SEND<br />
2017-05-01 22:45:05 DROP UDP ::1 ff02::c 49665 3702 0 - - - - - - - SEND<br />
2017-05-01 22:45:05 DROP UDP 127.0.0.1 239.255.255.250 49664 3702 0 - - - - - - - SEND<br />
2017-05-01 22:45:06 DROP UDP ::1 ff02::c 49665 3702 0 - - - - - - - SEND<br />
2017-05-01 22:45:06 DROP UDP 127.0.0.1 239.255.255.250 49664 3702 0 - - - - - - - SEND<br />
2017-05-01 22:45:06 DROP UDP ::1 ff02::c 49665 3702 0 - - - - - - - SEND<br />
2017-05-01 22:45:34 DROP ICMP ::1 ff02::16 - - 0 - - - - 143 0 - SEND<br />
2017-05-01 22:45:34 DROP ICMP ::1 ff02::16 - - 0 - - - - 143 0 - SEND<br />
2017-05-01 22:45:34 DROP 2 127.0.0.1 224.0.0.22 - - 0 - - - - - - - SEND<br />
2017-05-01 22:45:34 DROP 2 127.0.0.1 224.0.0.22 - - 0 - - - - - - - SEND<br />
2017-05-01 22:45:34 DROP 2 127.0.0.1 224.0.0.22 - - 0 - - - - - - - SEND<br />
2017-05-01 22:45:34 DROP ICMP ::1 ff02::16 - - 0 - - - - 143 0 - SEND<br />
2017-05-01 22:59:57 DROP 2 127.0.0.1 224.0.0.22 - - 0 - - - - - - - SEND<br />
2017-05-01 22:59:57 DROP ICMP ::1 ff02::16 - - 0 - - - - 143 0 - SEND<br />
2017-05-01 22:59:57 DROP 2 127.0.0.1 224.0.0.22 - - 0 - - - - - - - SEND<br />
2017-05-01 22:59:57 DROP ICMP ::1 ff02::16 - - 0 - - - - 143 0 - SEND<br />
</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
        <div id="pagerTop" class="pager-container clearBoth">
            <div id="pagerTopDesktop">
<meta name="awa-prevPage" content="1" />
<div>
            </span>
                        <span>
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Jomel_Santos" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display lime362 avatar-size-extrasmall"; this.setAttribute("alt", "JO"); this.style="display: inline-block";'
<h3> jomel_santos  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Hi Sonya,</p>
<p>
</p><p>For us to effectively assist you, kindly provide us the information we need below:</p>
<p>
</p><ul>
<li>Prior to when the issue started, have you made any significant changes to your computer?</li><li>When you said that you did a new install, are you meaning that you have performed a clean install of Windows 10?</li><li>Do you have any antivirus programs currently installed on your computer? Have you tried to fully scan your device?</li></ul>
<p>
</p><p>Regards.</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sonya l  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Sorry no changes, and the issue started a couple years ago about the time Windows 8 came out with my files getting leaked. Now just going over event viewer I discovered 5 powershell events at the exact time that this .pbk file was created.</p>
<p>
</p><p>I have scanned the computer with every scan out there for well over a year, I have only been told that everything seems normal when asking for help in security forums. It doesn't seem normal to me - I have remote desktop events such as "session 1 disconnected
 by session 1 code 11"</p>
<p>
</p><p>I have plenty of "s%from%S" also shown in eventviewer for remote desktop, and of course "!@#$"</p>
<p>
</p><p>
</p><p>I will copy and paste these events for powershell - these are "remote execute" commands. Oh and if you will take notice of the 4th script "route print" I do not have a printer on that pc, never have, uninstalled the defaults from device manager and deleted
 the "printserver" found under print management.</p>
<p>
<table>
<tbody>
<tr>
<td><strong>-</strong></td>
<td><strong>System</strong></td>
</tr>
</tbody>
</table>
</p><p>
</p><div>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><strong>-</strong></td>
<td><strong>Provider</strong></td>
</tr>
</tbody>
</table>
<div>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><br />
</td>
<td>[ <strong>Name</strong>] </td>
<td>Microsoft-Windows-PowerShell</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><br />
</td>
<td>[ <strong>Guid</strong>] </td>
<td>{A0C1853B-5C40-4B15-8766-3CF1C58F985A}</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>EventID</strong></td>
<td>53504</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>Version</strong></td>
<td>1</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>Level</strong></td>
<td>4</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>Task</strong></td>
<td>111</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>Opcode</strong></td>
<td>10</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>Keywords</strong></td>
<td>0x0</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><strong>-</strong></td>
<td><strong>TimeCreated</strong></td>
</tr>
</tbody>
</table>
<div>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><br />
</td>
<td>[ <strong>SystemTime</strong>] </td>
<td>2017-05-02T02:45:19.867004600Z</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>EventRecordID</strong></td>
<td>1</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><strong>-</strong></td>
<td><strong>Correlation</strong></td>
</tr>
</tbody>
</table>
<div>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><br />
</td>
<td>[ <strong>ActivityID</strong>] </td>
<td>{626845BB-C2DC-0000-E94B-6862DCC2D201}</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><strong>-</strong></td>
<td><strong>Execution</strong></td>
</tr>
</tbody>
</table>
<div>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><br />
</td>
<td>[ <strong>ProcessID</strong>] </td>
<td>3188</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><br />
</td>
<td>[ <strong>ThreadID</strong>] </td>
<td>1572</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>Channel</strong></td>
<td>Microsoft-Windows-PowerShell/Operational</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><strong>Computer</strong></td>
<td>SONYA</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td>
<table>
<tbody>
<tr>
<td><strong>-</strong></td>
<td><strong>Security</strong></td>
</tr>
</tbody>
</table>
<div>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><br />
</td>
<td>[ <strong>UserID</strong>] </td>
<td>S-1-5-21-365782308-2600114137-4046115346-1001</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><strong>-</strong></td>
<td><strong>EventData</strong></td>
</tr>
</tbody>
</table>
<div>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><strong>param1</strong></td>
<td>3188</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td><br />
</td>
<td><br />
</td>
<td><strong>param2</strong></td>
<td>DefaultAppDomain</td>
</tr>
</tbody>
</table>
<p><br />
</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sonya l  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Creating Scriptblock text (1 of 4):<br />
# Copyright © 2008, Microsoft Corporation. All rights reserved.<br />
<br />
function GetRuntimePath([string]$fileName = $(throw "No file name is specified"))<br />
{<br />
&nbsp;&nbsp;&nbsp; if([string]::IsNullorEmpty($fileName))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw "Invalid file name"<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp; [string]$runtimePath =&nbsp; [System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory()<br />
&nbsp;&nbsp;&nbsp;&nbsp; return Join-Path $runtimePath $fileName<br />
}<br />
<br />
function RegSnapin([string]$dllName = $(throw "No dll is specified"))<br />
{<br />
&nbsp;&nbsp;&nbsp; $dllPath = ".\" + $dllName<br />
&nbsp;&nbsp;&nbsp; Import-Module $dllPath<br />
}<br />
<br />
function UnregSnapin([string]$dllName = $(throw "No dll is specified"))<br />
{&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp;&nbsp; $moduleName = $dllName.TrimEnd(".dll")<br />
&nbsp;&nbsp;&nbsp; Remove-Module $moduleName<br />
}<br />
<br />
function GetExistingNDFInstance($IncidentID)<br />
{<br />
&nbsp;&nbsp;&nbsp; &amp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #if fails we start a new session<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script:ExpectingException = $true<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ndf = new-object -comObject ndfapi.NetworkDiagnostics.1 -strict<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ndf.OpenExistingIncident($IncidentID); #throws exception if fails<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script:ExpectingException = $false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $ndf<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($script:ExpectingException)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script:ExpectingException = $false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Exception: " + $_.Exception.GetType().FullName + " Message: " + $_.Exception.Message&nbsp; | convertto-xml | Update-DiagReport -id OpenExistingSessionFailure -name "Open Existing Session" -description "Failed while opening existing NDF session." -verbosity
 Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #rethrow exception<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw $_.Exception;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function WaitWithProgress($ActivityNoDetails, $WaitHandle, $Ndf)<br />
{<br />
&nbsp;&nbsp;&nbsp; $lastProgress = $null<br />
&nbsp;&nbsp;&nbsp; do {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $progress = $Ndf.Progress<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(($progress -ne $null) -and ($progress.Length -gt 0) -and !($progress -eq $lastProgress))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Write-DiagProgress -activity $progress<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $lastProgress = $progress<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif(($progress.Length -eq 0) -and !($ActivityNoDetails -eq $lastProgress))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #clear the last progress string, use alternate description of operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Write-DiagProgress -activity $ActivityNoDetails<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $lastProgress = $ActivityNoDetails<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $WaitHandle.Wait($ProgressUpdateDelay)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #timed out, continue waiting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } while($true)<br />
}<br />
<br />
# if filtered mode is enabled and the root cause is not on the filter list then return TRUE<br />
function GetRootCauseFilterValue($RootCause, [ref]$FilterMode)<br />
{<br />
&nbsp;&nbsp;&nbsp; #assume filtering is enabled<br />
&nbsp;&nbsp;&nbsp; $filteringEnabled = $true;<br />
&nbsp;&nbsp;&nbsp; if($FilterMode)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $FilterMode.value = 0;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $regValue = get-itemproperty -path hklm:\SYSTEM\CurrentControlSet\Control\NetDiagFx\Config&nbsp; -name FilterMode -ErrorAction SilentlyContinue -ErrorVariable regError<br />
&nbsp;&nbsp;&nbsp; if($regValue)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($FilterMode)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $FilterMode.value = $regValue.FilterMode;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $filteringEnabled = !($regValue.FilterMode -eq $FM_DISABLED);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($regError)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!($regError[0].CategoryInfo.Category -eq "InvalidArgument") -and !($regError[0].CategoryInfo.Category -eq "ObjectNotFound"))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; " Warning: Unexpected error when reading FilterMode key: " + $regError[0].CategoryInfo.Category | convertto-xml | Update-DiagReport -id UnexpectedRegError -name "Unexpected Registry Error" -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if(!$filteringEnabled)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #allow all root causes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $FV_NOTFILTERED;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #get the registry value and make the filtering decision<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rootCauseID = $RootCause.RootCauseID;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $regValue = get-itemproperty -path hklm:\SYSTEM\CurrentControlSet\Control\NetDiagFx\Config\RC&nbsp; -name $rootCauseID -ErrorAction SilentlyContinue -ErrorVariable regError<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($regValue)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #root cause present, check the entry type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $filterValue = $regValue.$rootCauseID;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($filterValue -eq 1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #exclusion list, force enabled filter mode so that the RC is dropped<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($FilterMode)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $FilterMode.value = $FM_ENABLED;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $FV_FILTERED;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #inclusion list, not filtered<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $FV_NOTFILTERED;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!($regError[0].CategoryInfo.Category -eq "InvalidArgument") -and&nbsp; !($regError[0].CategoryInfo.Category -eq "ObjectNotFound"))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; " Warning: Unexpected error when reading Root Cause key : " + $regError[0].CategoryInfo.Category | convertto-xml | Update-DiagReport -id UnexpectedRegError -name "Unexpected Registry Error" -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #could not find root cause<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $FV_MISSING;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function GetCatchAllInformation($RootCauseEnum, [ref]$CatchAlls, [ref]$CatchAllsIndex, [ref]$CatchAllsAltRC)<br />
{<br />
&nbsp;&nbsp;&nbsp; $localCatchAlls&nbsp; = @{}; #will contain the RC's with catch all repairs, indexed by HC it applies to<br />
&nbsp;&nbsp;&nbsp; $localCatchAllsIndex = @{}; #will hold the index of the catch-all in the root cause list<br />
&nbsp;&nbsp;&nbsp; $localCatchAllsAltRC = @{}; #will contain the alternate RC ID for the catch all, if available, indexed by root cause<br />
<br />
&nbsp;&nbsp;&nbsp; $rootCauseCount = $RootCauseEnum.Count;<br />
&nbsp;&nbsp;&nbsp; $RootCauseEnum.Reset()<br />
&nbsp;&nbsp;&nbsp; for($i=0; $i -lt $rootCauseCount; $i++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rootCause=$RootCauseEnum.Next;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repairEnum = $rootCause.Repairs;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repairCount = $repairEnum.Count;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repairEnum.Reset();<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($curRep=0; $curRep -lt $repairCount; $curRep++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repair = $repairEnum.Next;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($repair.Flags -band $RF_RESERVED_CA)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $altRC = GetExtensionValue ($repair.DescriptionEx) ("CatchAllRC");<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #HC's this applies to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $catchAllHCString =&nbsp; GetExtensionValue ($repair.DescriptionEx) ("CatchAllHCs");<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($catchAllHCString)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #semi-colon separated<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $catchAllHCList = $catchAllHCString.Split(";");<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($curHC=0; $catchAllHCList[$curHC]; $curHC++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #if a RC is filtered for this HC, this catch all will be used<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $localCatchAlls[$catchAllHCList[$curHC]]= $rootCause;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($altRC)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #store the alternate RC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $localCatchAllsAltRC[$rootCause] = $altRC;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #store the index<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $localCatchAllsIndex[$rootCause]= $i;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #return back the values collected<br />
&nbsp;&nbsp;&nbsp; if($CatchAlls)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $CatchAlls.value = $localCatchAlls;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if($CatchAllsIndex)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $CatchAllsIndex.value = $localCatchAllsIndex;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if($CatchAllsAltRC)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $CatchAllsAltRC.value = $localCatchAllsAltRC;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function GetParameters($DescriptionEx, $Params)<br />
{<br />
&nbsp;&nbsp;&nbsp; $toReturn = @{};<br />
<br />
&nbsp;&nbsp;&nbsp; #this is a XML based root cause, get replacement parameters<br />
&nbsp;&nbsp;&nbsp; $paramEnum = $DescriptionEx.Parameters;<br />
&nbsp;&nbsp;&nbsp; $paramCount = $paramEnum.Count;<br />
&nbsp;&nbsp;&nbsp; $paramEnum.Reset()<br />
&nbsp;&nbsp;&nbsp; for($curP=0;$curP -lt $paramCount; $curP++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $param = $paramEnum.Next;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($Params[$param.Name] -eq $null)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn += @{$param.Name = $param.Value}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $toReturn;<br />
}<br />
<br />
function GetKeywords($DescriptionEx)<br />
{<br />
&nbsp;&nbsp;&nbsp; if($DescriptionEx -eq $nul)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "";<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $toReturn = "";<br />
<br />
&nbsp;&nbsp;&nbsp; #this is a XML based root cause, get replacement parameters<br />
&nbsp;&nbsp;&nbsp; $paramEnum = $DescriptionEx.Extensions;<br />
&nbsp;&nbsp;&nbsp; $paramCount = $paramEnum.Count;<br />
&nbsp;&nbsp;&nbsp; $paramEnum.Reset()<br />
&nbsp;&nbsp;&nbsp; for($curP=0;$curP -lt $paramCount; $curP++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $param = $paramEnum.Next;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($param.Name -eq "Keyword")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($toReturn.Length -gt 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn += "+";<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn += """" + $param.Value + """";<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $toReturn.Replace(" ", "+");<br />
}<br />
<br />
function GetExtensionValue($DescriptionEx, $ExtensionName)<br />
{<br />
&nbsp;&nbsp;&nbsp; if($DescriptionEx)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $paramEnum = $DescriptionEx.Extensions;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $paramCount = $paramEnum.Count;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $paramEnum.Reset()<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($curP=0;$curP -lt $paramCount; $curP++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $param = $paramEnum.Next;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($param.Name -eq $ExtensionName)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $param.Value;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $null;<br />
}<br />
<br />
#are we an administrator or LUA?<br />
function IsAdmin()<br />
{<br />
&nbsp;&nbsp;&nbsp; $identity = [System.Security.Principal.WindowsIdentity]::GetCurrent()<br />
&nbsp;&nbsp;&nbsp; $principal = [System.Security.Principal.WindowsPrincipal]($identity)<br />
&nbsp;&nbsp;&nbsp; return $principal.IsInRole([System.Security.Principal.WindowsBuiltInRole]::Administrator)<br />
}<br />
<br />
#the security boundary safe data now contains two items of information<br />
#(1) the incident ID GUID (without the { } brackets)<br />
#(2) flags: whether the process is LUA (0) or Admin (1)<br />
#the two items are separated by a semicolon<br />
function GetSBSData($IncidentID)<br />
{<br />
&nbsp;&nbsp;&nbsp; $flags = 0<br />
&nbsp;&nbsp;&nbsp; $admin = IsAdmin<br />
&nbsp;&nbsp;&nbsp; if($admin)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $flags = 1<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $IncidentID.Substring(1,$IncidentID.Length-2) +":"+$flags<br />
}<br />
<br />
#the function takes a security boundary safe data and splits it into<br />
#the incident ID GUID (putting back the {} brackets), and the<br />
#flags<br />
function SplitSBSData($SBSData, [ref]$IncidentID, [ref]$Flags)<br />
{<br />
&nbsp;&nbsp;&nbsp; $IncidentID.value = "{" + $SBSData.Substring(0,$SBSData.IndexOf(":")) + "}"<br />
&nbsp;&nbsp;&nbsp; $Flags.value = $SBSData.Substring($SBSData.IndexOf(":")+1)<br />
}<br />
<br />
function GetInstanceHashCode($RootCause, $CatchAllInUse)<br />
{<br />
&nbsp;&nbsp;&nbsp; $hashCode = "";<br />
<br />
&nbsp;&nbsp;&nbsp; $repairEnum = $RootCause.Repairs;<br />
&nbsp;&nbsp;&nbsp; $repairCount = $repairEnum.Count;<br />
&nbsp;&nbsp;&nbsp; $repairEnum.Reset();<br />
&nbsp;&nbsp;&nbsp; if($repairCount -gt 0)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repair = $repairEnum.Next<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($CatchAllInUse)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #make sure we use the hash for the first catch-all repair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($i=0; ($i -lt $repairEnum.Count) -and (!($repair.Flags -band $RF_RESERVED_CA)); $i++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repair = $repairEnum.Next;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $hashCode = $repair.Description.GetHashCode();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $hashCode = $RootCause.Description.GetHashCode();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $hashCode;<br />
}<br />
<br />
function GetInstanceIDRC($RootCause, $CatchAlls, $CatchAllsAltRC)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; $rootCause = $RootCause;<br />
&nbsp;&nbsp;&nbsp; $rootCauseID = $RootCause.RootCauseID;<br />
<br />
&nbsp;&nbsp;&nbsp; #if catch all is in use, we need to use the catch all root cause information in the<br />
&nbsp;&nbsp;&nbsp; #instance ID so that all catch-all matches go to the same root cause in the session<br />
&nbsp;&nbsp;&nbsp; $catchAllInUse = $null;<br />
&nbsp;&nbsp;&nbsp; $filterValue = GetRootCauseFilterValue ($RootCause) ($null);<br />
&nbsp;&nbsp;&nbsp; if($filterValue -eq $FV_MISSING)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #rc is not in the filter list, catch all instance ID information should be used if present<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $className = $rootCause.ClassName;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($className)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #is there a chatch all fo the helper class?<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $catchAllRC = $CatchAlls[$className];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($catchAllRC)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #user the catch-all root cause<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rootCause = $catchAllRC;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #does the catch-all have an alternate root cause?<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $altRCID = $CatchAllsAltRC[$catchAllRC];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($altRCID)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #use alternate root cause ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rootCauseID = $catchAllsAltRC[$catchAllRC];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $catchAllInUse = $true;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $hashCode = GetInstanceHashCode($rootCause) ($catchAllInUse);<br />
&nbsp;&nbsp;&nbsp; return $rootCauseID.Substring(1,$rootCauseID.Length-2) + ":" + $hashCode;<br />
}<br />
<br />
function GetInstanceID($RootCauseIndex, $RootCauses, $CatchAlls, $CatchAllsAltRC)<br />
{<br />
&nbsp;&nbsp;&nbsp; #approach for generating unique instance ID:<br />
&nbsp;&nbsp;&nbsp; # (1) the root cause GUID (stripped of the { })<br />
&nbsp;&nbsp;&nbsp; # (2) the hash code&nbsp; of the first repair's text<br />
&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp; the repair text is guaranteed to be unique between root causes, and constant across reruns<br />
&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp; If no repairs, then the root cause text hash code is used<br />
<br />
&nbsp;&nbsp;&nbsp; $hashCode = 0<br />
&nbsp;&nbsp;&nbsp; $rootCauseID = 0<br />
<br />
&nbsp;&nbsp;&nbsp; #find the first repair for this root cause<br />
&nbsp;&nbsp;&nbsp; $rootCauseCount = $RootCauses.Count<br />
&nbsp;&nbsp;&nbsp; $RootCauses.Reset()<br />
&nbsp;&nbsp;&nbsp; for($i=0; $i -lt $rootCauseCount; $i++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rootCause=$RootCauses.Next;<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #root cause index is the index of the root cause in the root cause list<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #find the specific root cause<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($i -eq $RootCauseIndex)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if($i -eq $rootCauseCount)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw "Could not find a root cause with index " + $RootCauseIndex;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return GetInstanceIDRC($rootCause) ($CatchAlls) ($CatchAllsAltRC);<br />
}<br />
<br />
function GetSkipReasonText($Reason)<br />
{<br />
&nbsp;&nbsp;&nbsp; #this is for debug, OK to not localize<br />
&nbsp;&nbsp;&nbsp; if($Reason -eq $NDF_SKIPREASON_ADAPTER)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "An interactive fix for another network interface has been attempted."<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($Reason -eq $NDF_SKIPREASON_DUPLICATE)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "Another repair with the same ID applying to the same network interface has been attempted."<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function InContextEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; $IT_HelperClassName = Get-DiagInput -ID "IT_HelperClassName"<br />
&nbsp;&nbsp;&nbsp; if($IT_HelperClassName -eq $null&nbsp;&nbsp; -or&nbsp; $IT_HelperClassName[0].Length -eq 0) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving HelperClassName from In-Context answer file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #get input attributes<br />
&nbsp;&nbsp;&nbsp; $IT_HelperAttributes = Get-DiagInput -ID "IT_HelperAttributes"<br />
&nbsp;&nbsp;&nbsp; if($IT_HelperAttributes -eq $null) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving HelperAttributes from In-Context answer file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return @{"HelperClassName" = $IT_HelperClassName; "HelperAttributes" = $IT_HelperAttributes}<br />
}<br />
<br />
function EscapeForRTF($Text)<br />
{<br />
&nbsp;&nbsp;&nbsp; $textToEscape = $Text.Replace("\","\\")<br />
<br />
&nbsp;&nbsp;&nbsp; $sb = New-Object System.Text.StringBuilder $textToEscape.Length;<br />
&nbsp;&nbsp;&nbsp; for($i=0; $i -lt $textToEscape.Length; $i++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curChar = $textToEscape[$i];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($curChar -eq '\n')<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $null = $sb.Append("\par");<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif(($curChar -lt 0x20) -or ($curChar -eq '{') -or ($curChar -eq '}') -or ($curChar -eq '\\'))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $null = $sb.Append("\'");<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $null = $sb.Append(([int]$curChar).ToString("X2", [System.Globalization.CultureInfo]::InvariantCulture));<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif($curChar -lt 0x80)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $null = $sb.Append($curChar);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $null = $sb.Append("\u");<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $null = $sb.Append(([int]$curChar).ToString([System.Globalization.CultureInfo]::InvariantCulture));<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $null = $sb.Append('?');<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; return $sb.ToString();<br />
<br />
}<br />
<br />
function IsValidURL($URL)<br />
{<br />
&nbsp;&nbsp;&nbsp; &amp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $uri = [System.URI]($URL);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $scheme = $uri.scheme;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(($scheme -eq "http" ) -or ($scheme -eq "https") -or ($scheme -eq "ftp"))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $uri.ToString();<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function GetDefaultBrowser()<br />
{<br />
&nbsp;&nbsp;&nbsp; [string]$assocString = $null<br />
&nbsp;&nbsp;&nbsp; $dll = "NetworkDiagnosticSnapIn.dll"<br />
<br />
&nbsp;&nbsp;&nbsp; try<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RegSnapin $dll<br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $assocString = [Microsoft.Windows.Diagnosis.Network.Associati<br />
<br />
ScriptBlock ID: e51aacde-e7b8-4366-bd80-0caf5c5b589a<br />
Path: C:\Users\Me\AppData\Local\Temp\SDIAG_d630b5e7-ff21-493c-98e2-b2ac45ea9525\UtilityFunctions.ps1<br />
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="3" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sonya l  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Creating Scriptblock text (2 of 4):<br />
onInfo]::GetAssociation("http","open");<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $assocString = $null;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; finally<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnregSnapin $dll<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $assocString;<br />
}<br />
<br />
function GetWebNDFIncidentData($URL, $DefaultConnectivity)<br />
{<br />
&nbsp;&nbsp;&nbsp; #build entry point parameters<br />
&nbsp;&nbsp;&nbsp; $haXML = "&lt;HelperAttributes&gt;&lt;HelperAttribute&gt;&lt;Name&gt;URL&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;&lt;![CDATA[" + $URL +&nbsp; "]]&gt;&lt;/Value&gt;&lt;/HelperAttribute&gt;"<br />
&nbsp;&nbsp;&nbsp; if($DefaultConnectivity)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #sqm explorer as the client rather than sdiaghost.exe<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $haXML += "&lt;HelperAttribute&gt;&lt;Name&gt;NDFSQMCallerApplication&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;Windows\Explorer.EXE&lt;/Value&gt;&lt;/HelperAttribute&gt;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $defaultBrowser = GetDefaultBrowser;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($defaultBrowser)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $haXML += "&lt;HelperAttribute&gt;&lt;Name&gt;AppID&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;"+ $defaultBrowser + "&lt;/Value&gt;&lt;/HelperAttribute&gt;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $haXML += "&lt;/HelperAttributes&gt;"<br />
&nbsp;&nbsp;&nbsp; return @{"HelperClassName" = "WinInetHelperClass"; "HelperAttributes" =$haXML}<br />
}<br />
<br />
function GetValidURL($CandidateURL)<br />
{<br />
&nbsp;&nbsp;&nbsp; $toReturn = $null<br />
&nbsp;&nbsp;&nbsp; $url = IsValidURL $CandidateURL<br />
&nbsp;&nbsp;&nbsp; if($url -eq $null)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($CandidateURL.IndexOf("://") -eq -1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $updatedURL = "http://" + $CandidateURL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $url = IsValidURL $updatedURL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($url)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = $url<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = $url<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $toReturn<br />
}<br />
<br />
function GetErrorRTF($Description, $Error)<br />
{<br />
&nbsp; $escapedDesc = EscapeForRTF $Description;<br />
&nbsp; $escapedError = EscapeForRTF $Error;<br />
&nbsp; $rtf = LoadResourceString($ERROR_MSG_RTF_RESOURCE);<br />
&nbsp; return $rtf.Replace("%DESC%", $escapedDesc).Replace("%ERROR%", $escapedError);<br />
}<br />
<br />
function WebEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; $IT_WebChoice = Get-DiagInput -ID "IT_WebChoice"<br />
&nbsp;&nbsp;&nbsp; if($IT_WebChoice -eq $null)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving Web Choice<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $IT_URL = $DefaultDiagURL<br />
&nbsp;&nbsp;&nbsp; if(!($IT_WebChoice -eq "Internet"))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_URL = Get-DiagInput -ID "IT_URL"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_URL -eq $null) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving URL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #verify that it is a valid URL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validURL = GetValidURL $IT_URL[0]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while($validURL -eq $null)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #build the RTF text<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $replacedError = [System.String]::Format([System.Globalization.CultureInfo]::InvariantCulture, $localizationString.interaction_InvalidURL_FormatError, $IT_URL[0]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $RTFText = GetErrorRTF ($localizationString.interaction_InvalidURL_Desc) ($replacedError);<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #reprompt for input<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_URL = Get-DiagInput -ID "IT_Invalid_URL" -p @{"URL" = $IT_URL; "RTFText" = $RTFText}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_URL -eq $null) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving URL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validURL = GetValidURL $IT_URL[0]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return GetWebNDFIncidentData $validURL $false<br />
}<br />
<br />
function IsUNCFormat($UNC)<br />
{<br />
&nbsp;&nbsp;&nbsp;&nbsp; &amp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $uri = [System.URI]($UNC);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $scheme = $uri.scheme;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(($scheme -eq "file" ))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($uri.IsUnc)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $uri.LocalPath;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
#function assumes passed in UNC is in \\host\share form (share can be missing)<br />
function ContainsInvalidUNCChars($UNC)<br />
{<br />
&nbsp;&nbsp;&nbsp; &amp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #will return an exception if the string has invalid characters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ignoreResult = [System.IO.Path]::IsPathRooted($UNC)<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #check the path for invalid characters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #remove the starting slashes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tmp = $UNC.Substring(2)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $nextSlash = $tmp.IndexOf("\")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(($nextSlash -lt 0) -or ($nextSlash -eq ($nextSlash.Length - 1)))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #string only contains hostname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #hostname is already validated in IsUNCFormat function<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #remove host and backslash after host<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $UNCPath = $tmp.Substring($nextSlash+1)<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #under certain circumstances some of these make it through the above check<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #so we do a direct sanity check here<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!($UNCPath.IndexOfAny(@('/',':','*','?','"','&lt;','&gt;','|')) -eq -1))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $true;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $false;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $true;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function GetValidUNC($CandidateUNC)<br />
{<br />
&nbsp;&nbsp;&nbsp; $toReturn = $null<br />
<br />
&nbsp;&nbsp;&nbsp; #is it valid<br />
&nbsp;&nbsp;&nbsp; $unc = IsUNCFormat $CandidateUNC<br />
&nbsp;&nbsp;&nbsp; if($unc)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $invalidChars = ContainsInvalidUNCChars $unc<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($invalidChars)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = -1;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = $unc<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $toReturn;<br />
}<br />
<br />
<br />
function GetUNCNDFIncidentData($UNC)<br />
{<br />
&nbsp;&nbsp;&nbsp; #build entry point parameters<br />
&nbsp;&nbsp;&nbsp; $haXML = "&lt;HelperAttributes&gt;&lt;HelperAttribute&gt;&lt;Name&gt;UNCPath&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;&lt;![CDATA[" + $UNC +&nbsp; "]]&gt;&lt;/Value&gt;&lt;/HelperAttribute&gt;&lt;/HelperAttributes&gt;"<br />
&nbsp;&nbsp;&nbsp; return @{"HelperClassName" = "SMBHelperClass"; "HelperAttributes" =$haXML}<br />
}<br />
<br />
function FileSharingEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; $IT_UNC = Get-DiagInput -ID "IT_UNC"<br />
&nbsp;&nbsp;&nbsp; if($IT_UNC -eq $null) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving UNC path<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #assign input to non-array variable to facilitate usage and transform<br />
&nbsp;&nbsp;&nbsp; $validUNC = GetValidUNC $IT_UNC[0]<br />
&nbsp;&nbsp;&nbsp; while((!$validUNC) -or ($validUNC -eq -1))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #build the RTF text<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #use original entry for re-prompt even though "file://" UNC may have been transformed<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $replacedError = "";<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!$validUNC)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $replacedError = [System.String]::Format([System.Globalization.CultureInfo]::InvariantCulture, $localizationString.interaction_InvalidUNC_FormatError, $IT_UNC[0]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $replacedError = [System.String]::Format([System.Globalization.CultureInfo]::InvariantCulture, $localizationString.interaction_InvalidUNC_CharError, $IT_UNC[0]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $RTFText = GetErrorRTF ($localizationString.interaction_InvalidUNC_Desc) ($replacedError);<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #reprompt for input<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_UNC = Get-DiagInput -ID "IT_Invalid_UNC" -p @{"UNC" = $IT_UNC; "RTFText" = $RTFText}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_UNC -eq $null) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving UNC path<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validUNC = GetValidUNC $IT_UNC[0]<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return GetUNCNDFIncidentData $validUNC<br />
}<br />
<br />
function NetworkAdapterEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; #enumerate interfaces to build options list<br />
&nbsp;&nbsp;&nbsp; $interfaces = get-wmiobject -class Win32_NetworkAdapter<br />
&nbsp;&nbsp;&nbsp; #hash table with options<br />
&nbsp;&nbsp;&nbsp; $optionList = @()<br />
&nbsp;&nbsp;&nbsp; foreach($curInterface in $interfaces)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($curInterface.GUID -ne $null)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash = @{"Name"=$curInterface.NetConnectionID}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash += @{"Description"=$curInterface.NetConnectionID}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash += @{"Value"=$curInterface.GUID}<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $optionList += @($curHash)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if($optionList.Count -gt 1)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #add zero guid entry to check all interfaces<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $optionList += @(@{"Name"=$localizationString.interaction_AllAdapters; "Description"=$localizationString.interaction_AllAdapters; "Value"="{00000000-0000-0000-0000-000000000000}"; "ExtensionPoint"="&lt;Default /&gt;"})<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #get interface selection from user<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_NetworkAdapter = Get-DiagInput -ID "IT_NetworkAdapter" -c $optionList<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_NetworkAdapter -eq $null) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw "Failed retriving Network Connetion ID from user"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($optionList.Count -eq 1)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_NetworkAdapter = $optionList[0]["Value"]<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #No NICs, do zero GUID diag<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_NetworkAdapter = "{00000000-0000-0000-0000-000000000000}"<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #build entry point parameters<br />
&nbsp;&nbsp;&nbsp; $haXML = "&lt;HelperAttributes&gt;&lt;HelperAttribute&gt;&lt;Name&gt;guid&lt;/Name&gt;&lt;Type&gt;AT_GUID&lt;/Type&gt;&lt;Value&gt;" + $IT_NetworkAdapter +&nbsp; "&lt;/Value&gt;&lt;/HelperAttribute&gt;&lt;/HelperAttributes&gt;"<br />
&nbsp;&nbsp;&nbsp; return @{"HelperClassName" = "NetConnection"; "HelperAttributes" =$haXML}<br />
}<br />
<br />
function WinsockEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; $IT_RemoteAddress = Get-DiagInput -ID "IT_RemoteAddress"<br />
&nbsp;&nbsp;&nbsp; if($IT_RemoteAddress -eq $null -or&nbsp; $IT_RemoteAddress[0].Length -eq 0) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving Remote Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $IT_Protocol = Get-DiagInput -ID "IT_Protocol"<br />
&nbsp;&nbsp;&nbsp; if($IT_Protocol -eq $null -or&nbsp; $IT_Protocol[0].Length -eq 0) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving Remote Port<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $IT_ApplicationID = Get-DiagInput -ID "IT_ApplicationID"<br />
&nbsp;&nbsp;&nbsp; if($IT_ApplicationID -eq $null -or&nbsp; $IT_ApplicationID[0].Length -eq 0) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving Application ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #build entry point parameters<br />
&nbsp;&nbsp;&nbsp; $haXML = "&lt;HelperAttributes&gt;&lt;HelperAttribute&gt;&lt;Name&gt;remoteaddr&lt;/Name&gt;&lt;Type&gt;AT_SOCKADDR&lt;/Type&gt;&lt;Value&gt;" + $IT_RemoteAddress&nbsp; +&nbsp; "&lt;/Value&gt;&lt;/HelperAttribute&gt;";<br />
&nbsp;&nbsp;&nbsp; $haXML += "&lt;HelperAttribute&gt;&lt;Name&gt;protocol&lt;/Name&gt;&lt;Type&gt;AT_UINT32&lt;/Type&gt;&lt;Value&gt;" + $IT_Protocol +&nbsp; "&lt;/Value&gt;&lt;/HelperAttribute&gt;";<br />
&nbsp;&nbsp;&nbsp; $haXML += "&lt;HelperAttribute&gt;&lt;Name&gt;localaddr&lt;/Name&gt;&lt;Type&gt;AT_SOCKADDR&lt;/Type&gt;&lt;Value&gt;0.0.0.0&lt;/Value&gt;&lt;/HelperAttribute&gt;";<br />
&nbsp;&nbsp;&nbsp; $haXML += "&lt;HelperAttribute&gt;&lt;Name&gt;appid&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;" + $IT_ApplicationID + "&lt;/Value&gt;&lt;/HelperAttribute&gt;";<br />
&nbsp;&nbsp;&nbsp; $haXML += "&lt;/HelperAttributes&gt;";<br />
&nbsp;&nbsp;&nbsp; return @{"HelperClassName" = "Winsock"; "HelperAttributes" =$haXML}<br />
}<br />
<br />
function GroupingEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; $IT_GroupName = Get-DiagInput -ID "IT_GroupName"<br />
&nbsp;&nbsp;&nbsp; if($IT_GroupName -eq $null -or&nbsp; $IT_GroupName[0].Length -eq 0) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving Remote Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #build entry point parameters<br />
&nbsp;&nbsp;&nbsp; $haXML = "&lt;HelperAttributes&gt;&lt;HelperAttribute&gt;&lt;Name&gt;groupname&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;" + $IT_GroupName +&nbsp; "&lt;/Value&gt;&lt;/HelperAttribute&gt;&lt;/HelperAttributes&gt;"<br />
&nbsp;&nbsp;&nbsp; return @{"HelperClassName" = "GroupingHelperClass"; "HelperAttributes" =$haXML}<br />
}<br />
<br />
function GetValidExePath($File)<br />
{<br />
&nbsp;&nbsp;&nbsp;&nbsp; &amp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $uri = [System.URI]($File);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $scheme = $uri.scheme;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(($scheme -eq "file" ))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #make sure it send in .exe<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($File.ToLower().IndexOf(".exe") -eq ($File.Length - 4))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $File;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function InboundEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; $staticOptionRes = @($INBOUND_FILESHARE_RESOURCE, $INBOUND_REMOTEDESKTOP_RESOURCE, $INBOUND_DISCOVERY_RESOURCE)<br />
&nbsp;&nbsp;&nbsp; $staticOptions = @($INBOUND_FILESHARE_PARAM, $INBOUND_REMOTEDESKTOP_PARAM, $INBOUND_DISCOVERY_PARAM)<br />
&nbsp;&nbsp;&nbsp; # If defined for the corresponding option, the item will be filtered out if the current sku matches anything in the list<br />
&nbsp;&nbsp;&nbsp; # Sku values as defined in the OperatingSystemSKU property of Win32_OperatingSystem<br />
&nbsp;&nbsp;&nbsp; $SKUFilters = @($null, @(2,3,5,11), $null)<br />
<br />
&nbsp;&nbsp;&nbsp; #get the SKU, to filter out inappropriate static options<br />
&nbsp;&nbsp;&nbsp; $SKUObject = get-wmiobject -class Win32_OperatingSystem -property "OperatingSystemSKU"<br />
&nbsp;&nbsp;&nbsp; $SKU = $SKUObject.OperatingSystemSKU<br />
<br />
&nbsp;&nbsp;&nbsp; $optionList = @()<br />
&nbsp;&nbsp;&nbsp; $curOptionIndex = 0<br />
&nbsp;&nbsp;&nbsp; for($curStaticOption = 0; $curStaticOption -lt $staticOptions.Length; $curStaticOption++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $SKUFilter = $SKUFilters[$curStaticOption]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($SKUFilter)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($SKUFilter -contains $SKU)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #should filter out this option from the list because it is not present in the SKU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curApp = LoadResourceString($staticOptionRes[$curStaticOption])<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash = @{}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("Name",$curApp)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("Value",$curOptionIndex)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("Description",$curApp)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("HelperAttributeName","serviceid")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("HelperAttributeValue",$staticOptions[$curStaticOption])<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $optionList += $curHash<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curOptionIndex++<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #add dynamic options (do not fail if call fails)<br />
&nbsp;&nbsp;&nbsp; $script:ExpectingException = $true<br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp;&nbsp; $dll = "NetworkDiagnosticSnapIn.dll"<br />
<br />
&nbsp;&nbsp;&nbsp; try<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RegSnapin $dll<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $droppedApps = [Microsoft.Windows.Diagnosis.Network.FirewallApi.ManagedMethods]::GetDiagnosticAppInfo()<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script:ExpectingException = $false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($droppedApps)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach($droppedApp in $droppedApps)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #omit svchosts since we cannot display a friendly name for them<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($droppedApp.Path.IndexOf("svchost") -eq -1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $appEntryDisplayStr = [System.String]::Format([System.Globalization.CultureInfo]::InvariantCulture, $localizationString.interaction_Inbound_Exe, $droppedApp.FriendlyName);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash = @{}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("Name",$appEntryDisplayStr)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("Value",$curOptionIndex)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("Description",$droppedApp.FriendlyName)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("HelperAttributeName","appid")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curHash.Add("HelperAttributeValue",$droppedApp.Path)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $optionList += $curHash<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curOptionIndex++<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; finally<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnregSnapin $dll<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #add the last option to browse for files<br />
&nbsp;&nbsp;&nbsp; $curApp = LoadResourceString($INBOUND_OTHER_RESOURCE)<br />
&nbsp;&nbsp;&nbsp; $curHash = @{}<br />
&nbsp;&nbsp;&nbsp; $curHash.Add("Name",$curApp)<br />
&nbsp;&nbsp;&nbsp; $curHash.Add("Value",$curOptionIndex)<br />
&nbsp;&nbsp;&nbsp; $curHash.Add("Description",$curApp)<br />
&nbsp;&nbsp;&nbsp; $curHash.Add("HelperAttributeName","serviceid")<br />
&nbsp;&nbsp;&nbsp; $curHash.Add("HelperAttributeValue",$INBOUND_OTHER_RESOURCE)<br />
&nbsp;&nbsp;&nbsp; $optionList += $curHash<br />
<br />
<br />
&nbsp;&nbsp;&nbsp; #trap exception if it happens, and if expected don't fail<br />
&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($script:ExpectingException)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script:ExpectingException = $false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Exception: " + $_.Exception.GetType().FullName + " Message: " + $_.Exception.Message&nbsp; | convertto-xml | Update-DiagReport -id GetDiagAppInfoFailure -name "GetDiagAppInfo" -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #rethrow exception<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw $_.Exception;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $IT_ServiceName = Get-DiagInput -ID "IT_ServiceName" -c $optionList<br />
&nbsp;&nbsp;&nbsp; if($IT_ServiceName -eq $null -or&nbsp; $IT_ServiceName[0].Length -eq 0) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving service name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $optionSelected = $optionList[$IT_ServiceName]<br />
&nbsp;&nbsp;&nbsp; $optionSelected = $optionSelected[0] #need to to this to get access to the dictionary entry object<br />
&nbsp;&nbsp;&nbsp; $HelperAttributeName = $null<br />
&nbsp;&nbsp;&nbsp; $HelperAttributeValue = $null<br />
<br />
&nbsp;&nbsp;&nbsp; if($optionSelected.HelperAttributeValue -eq $INBOUND_OTHER_RESOURCE)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #show the file browsing interaction so that the user can pick their own executable<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_BrowseFile = Get-DiagInput -ID "IT_BrowseFile"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_BrowseFile -eq $null) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validExe = GetValidExePath $IT_BrowseFile[0]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while(!$validExe)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #build the RTF text<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #build the error<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $replacedError = [System.String]::Format([System.Globalization.CultureInfo]::InvariantCulture, $localizationString.interaction_InvalidExe_FormatError , $IT_BrowseFile[0]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #only a single line<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $RTFText = GetErrorRTF ($localizationString.interaction_InvalidExe_Desc) ($replacedError);<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #reprompt for input<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_BrowseFile = Get-DiagInput -ID "IT_Invalid_BrowseFile" -p @{"File" = $IT_BrowseFile[0]; "RTFText" = $RTFText}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_BrowseFile -eq $null) {<br />
<br />
<br />
ScriptBlock ID: e51aacde-e7b8-4366-bd80-0caf5c5b589a<br />
Path: C:\Users\Me\AppData\Local\Temp\SDIAG_d630b5e7-ff21-493c-98e2-b2ac45ea9525\UtilityFunctions.ps1<br />
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="4" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sonya l  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Creating Scriptblock text (3 of 4):<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validExe = GetValidExePath $IT_BrowseFile[0]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $HelperAttributeName = "appid"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $HelperAttributeValue = $IT_BrowseFile;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $HelperAttributeName = $optionSelected.HelperAttributeName<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $HelperAttributeValue = $optionSelected.HelperAttributeValue<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #build entry point parameters<br />
&nbsp;&nbsp;&nbsp; $haXML = "&lt;HelperAttributes&gt;"<br />
&nbsp;&nbsp;&nbsp; $haXML += "&lt;HelperAttribute&gt;&lt;Name&gt;" + $HelperAttributeName + "&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;" + $HelperAttributeValue +&nbsp; "&lt;/Value&gt;&lt;/HelperAttribute&gt;"<br />
&nbsp;&nbsp;&nbsp; $haXML += "&lt;HelperAttribute&gt;&lt;Name&gt;localaddr&lt;/Name&gt;&lt;Type&gt;AT_SOCKADDR&lt;/Type&gt;&lt;Value&gt;0.0.0.0&lt;/Value&gt;&lt;/HelperAttribute&gt;"<br />
&nbsp;&nbsp;&nbsp; $haXML += "&lt;/HelperAttributes&gt;"<br />
&nbsp;&nbsp;&nbsp; return @{"HelperClassName" = "Winsock"; "HelperAttributes" =$haXML}<br />
}<br />
<br />
function DirectAccessEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; $toReturn = $null;<br />
<br />
&nbsp;&nbsp;&nbsp; $path = "hklm:SOFTWARE\Policies\Microsoft\Windows\NetworkConnectivityStatusIndicator\CorporateConnectivity";<br />
&nbsp;&nbsp;&nbsp; if(test-path $path)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $corpReg = get-itemproperty -path $path<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($corpReg.WebProbeURL -and $corpReg.WebProbeURL.Length -gt 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #build entry point parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $haXML = "&lt;HelperAttributes&gt;&lt;HelperAttribute&gt;&lt;Name&gt;URL&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;" + $corpReg.WebProbeURL +&nbsp; "&lt;/Value&gt;&lt;/HelperAttribute&gt;&lt;/HelperAttributes&gt;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = @{"HelperClassName" = "WinInetHelperClass"; "HelperAttributes" =$haXML}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif($corpReg.DnsProbeHost -and $corpReg.DnsProbeHost&nbsp; -gt 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #build entry point parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $haXML = "&lt;HelperAttributes&gt;&lt;HelperAttribute&gt;&lt;Name&gt;QueryName&lt;/Name&gt;&lt;Type&gt;AT_STRING&lt;/Type&gt;&lt;Value&gt;" + $corpReg.DnsProbeHost +&nbsp; "&lt;/Value&gt;&lt;/HelperAttribute&gt;&lt;/HelperAttributes&gt;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = @{"HelperClassName" = "DnsHelperClass"; "HelperAttributes" =$haXML}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $toReturn;<br />
}<br />
<br />
function DefaultConnectivityFollowUpEntry()<br />
{<br />
&nbsp;&nbsp;&nbsp; $toReturn = $null<br />
<br />
&nbsp;&nbsp;&nbsp; $IT_DefaultConnectivityInitialChoice = Get-DiagInput -ID "IT_DefaultConnectivityInitialChoice"<br />
&nbsp;&nbsp;&nbsp; if($IT_DefaultConnectivityInitialChoice -eq $null -or&nbsp; $IT_DefaultConnectivityInitialChoice[0].Length -eq 0)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving service name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #clear the progress so that the last step doesn't show before things get started again<br />
&nbsp;&nbsp;&nbsp; Write-DiagProgress -activity " "<br />
<br />
&nbsp;&nbsp;&nbsp; if($IT_DefaultConnectivityInitialChoice -eq "Other")<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #query which other entry point they wish to use<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_DefaultConnectivityOtherChoice = Get-DiagInput -ID "IT_DefaultConnectivityOtherChoice"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_DefaultConnectivityOtherChoice[0].Length -eq 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving service name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_DefaultConnectivityOtherChoice -eq "Inbound")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = InboundEntry<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif($IT_DefaultConnectivityOtherChoice -eq "DirectAccess")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = DirectAccessEntry<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!$toReturn)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #not provisioned, root cause outside of NDF<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Update-DiagRootCause -ID "{E42E5B5A-16E0-43f1-AB32-C94C608D269D}" -Detected $true<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif($IT_DefaultConnectivityOtherChoice -eq "NetworkAdapter")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = NetworkAdapterEntry<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #query for the URL/UNC path<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_URLOrUNC = Get-DiagInput -ID "IT_URLOrUNC"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validUNC = $null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Is it a valid URL?<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validURL = GetValidURL $IT_URLOrUNC[0]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!$validURL)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validUNC = GetValidUNC $IT_URLOrUNC[0]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while((!$validURL) -and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((!$validUNC) -or ($validUNC -eq -1)))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #build the RTF text<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $replacedError = [System.String]::Format([System.Globalization.CultureInfo]::InvariantCulture, $localizationString.interaction_InvalidURLOrUNC_FormatError, $IT_URLOrUNC[0]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $RTFText = GetErrorRTF ($localizationString.interaction_InvalidURLOrUNC_Desc) ($replacedError);<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #reprompt for input<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $IT_URLOrUNC = Get-DiagInput -ID "IT_Invalid_URLOrUNC" -p @{"URLOrUNC" = $IT_URLOrUNC; "RTFText" = $RTFText}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($IT_URLOrUNC -eq $null) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Failed retriving URL/UNC path<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validURL = GetValidURL $IT_URLOrUNC[0]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!$validURL)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $validUNC = GetValidUNC $IT_URLOrUNC[0]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($validURL)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = GetWebNDFIncidentData $validURL $false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $toReturn = GetUNCNDFIncidentData $validUNC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $toReturn<br />
}<br />
<br />
function GetRepair($RepairRank, $RCEnum)<br />
{<br />
&nbsp;&nbsp;&nbsp; $RCEnum.Reset()<br />
&nbsp;&nbsp;&nbsp; $rootCauseCount = $RCEnum.Count<br />
&nbsp;&nbsp;&nbsp; for($i=0; $i -lt $rootCauseCount; $i++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rootCause = $RCEnum.Next;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repairEnum = $rootCause.Repairs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repairCount = $repairEnum.Count;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($r=0; $r -lt $repairCount; $r++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $curRep = $repairEnum.Next<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($curRep.Rank -eq $RepairRank)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $curRep<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $null<br />
}<br />
<br />
function SplitString($FullString, [ref]$Title, [ref]$Rest)<br />
{<br />
&nbsp;&nbsp;&nbsp;&nbsp; $newLineIndex = $FullString.IndexOf("`n");<br />
&nbsp;&nbsp;&nbsp;&nbsp; if(!($newLineIndex -eq -1))<br />
&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Title.value = $FullString.Substring(0, $newLineIndex)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Rest.value = $FullString.Substring($newLineIndex+1)<br />
&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Title.value = $FullString<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Rest.value = ""<br />
&nbsp;&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function GetTitleAndDesc($RCorRep, [ref]$Title, [ref]$Desc)<br />
{<br />
&nbsp;&nbsp;&nbsp; $descEx = $RCorRep.DescriptionEx<br />
&nbsp;&nbsp;&nbsp; if(!($descEx -eq $null))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Title.value = $descEx.Title<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Desc.value = $descEx.Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($Desc.value -eq $null)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Desc.value = ""<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #split the string into title and description using \n<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SplitString $RCorRep.Description ($Title) ($Desc)<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function GetButtonParams($Repair, [ref]$Params, $DefaultName, $DefaultDesc, $ExtensionName, $ButtonITName, $ButtonITDesc)<br />
{<br />
&nbsp;&nbsp;&nbsp; #defaults<br />
&nbsp;&nbsp;&nbsp; $buttonName = $DefaultName;<br />
&nbsp;&nbsp;&nbsp; $buttonDesc = $DefaultDesc;<br />
<br />
&nbsp;&nbsp;&nbsp; $descriptionEx = $Repair.DescriptionEx;<br />
<br />
&nbsp;&nbsp;&nbsp; if($descriptionEx)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #this is a XML based root cause, get replacement parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $paramEnum = $DescriptionEx.Extensions;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $paramCount = $paramEnum.Count;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $paramEnum.Reset()<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($curP=0;$curP -lt $paramCount; $curP++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $param = $paramEnum.Next;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($param.Name -eq $ExtensionName)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SplitString $param.Value ([ref]$buttonName) ([ref]$buttonDesc);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $Params.value.Add($ButtonITName, $buttonName);<br />
&nbsp;&nbsp;&nbsp; $Params.value.Add($ButtonITDesc, $buttonDesc);<br />
}<br />
<br />
function GetContinueButtonParams($Repair, [ref]$Params)<br />
{<br />
&nbsp;&nbsp;&nbsp; GetButtonParams $Repair $Params $localizationString.interaction_DefaultContinueButtonName $localizationString.interaction_DefaultContinueButtonDescription "ContinueButtonText" "IT_P_ContinueButtonName" "IT_P_ContinueButtonDescription"<br />
}<br />
<br />
function GetLaunchButtonParams($Repair, [ref]$Params)<br />
{<br />
&nbsp;&nbsp;&nbsp; GetButtonParams $Repair $Params $localizationString.interaction_DefaultLaunchButtonName "" "LaunchButtonText" "IT_P_LaunchButtonName" "IT_P_LaunchButtonDescription"<br />
}<br />
<br />
function GetUnmanifestedRootCause($RootCause, [ref]$Params, $catchAllRC)<br />
{<br />
&nbsp;&nbsp;&nbsp; #Get name and description of root cause<br />
&nbsp;&nbsp;&nbsp; $Name = "";<br />
&nbsp;&nbsp;&nbsp; $Desc = "";<br />
&nbsp;&nbsp;&nbsp; #don't use DescriptionEx for unmanifested root causes<br />
&nbsp;&nbsp;&nbsp; SplitString $RootCause.Description ([ref]$Name) ([ref]$Desc)<br />
&nbsp;&nbsp;&nbsp; #add to outgoing param list<br />
&nbsp;&nbsp;&nbsp; $Params.value.Add("RootCauseName", $Name);<br />
&nbsp;&nbsp;&nbsp; $Params.value.Add("RootCauseDescription", $Desc);<br />
<br />
&nbsp;&nbsp;&nbsp; #check whether repairs require elevation of not<br />
&nbsp;&nbsp;&nbsp; $LUARepairs = @();<br />
&nbsp;&nbsp;&nbsp; $elevateRepairs = @();<br />
&nbsp;&nbsp;&nbsp; $localRepairs = @();<br />
<br />
&nbsp;&nbsp;&nbsp; $repairEnum = $rootCause.Repairs<br />
&nbsp;&nbsp;&nbsp; $repairEnum.Reset()<br />
&nbsp;&nbsp;&nbsp; for($i=0; $i -lt $repairEnum.Count; $i++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repair = $repairEnum.Next<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($catchAllRC -and !($repair.Flags -band $RF_RESERVED_CA))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #this is a catch all RC treatment, so we should skip the non-catch all repairs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif(!$catchAllRC -and ($repair.Flags -band $RF_RESERVED_CA))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #this is not a catch all RC treatment, so we should skip catch all repairs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $requiredSid = $Repair.RequiredSidType;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($requiredSid -eq $null)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw "Could not retrieve required repair SID"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif(($requiredSid -eq&nbsp; $WinBuiltinAdministratorsSid) -or ($requiredSid -eq&nbsp; $WinBuiltinNetworkConfigurationOperatorsSid))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $elevateRepairs += @($repair);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif($requiredSid -eq&nbsp; $WinLocalLogonSid)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $localRepairs += @($repair);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $LUARepairs += @($repair);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $LUACount = $LUARepairs.Length;<br />
&nbsp;&nbsp;&nbsp; $elevateCount = $elevateRepairs.Length;<br />
&nbsp;&nbsp;&nbsp; $localCount = $localRepairs.Length;<br />
<br />
&nbsp;&nbsp;&nbsp; if($elevateCount + $LUACount -gt 2)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #currently we don't support more than two repairs for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #unmanifested repairs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "LUA: " + $LUACount + " Elevation: " + $elevateCount | convertto-xml | Update-DiagReport -id UnmanifestedRootCause -name "Unmanifested Root Cause" -description "Unsupported number of total repairs for unmanifested root cause." -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($localCount -and ($elevateCount -or $LUACount))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #we don't support a combination of Local repairs with any other kind of repair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "LUA: " + $LUACount + " Elevation: " + $elevateCount | convertto-xml | Update-DiagReport -id UnmanifestedRootCause -name "Unmanifested Root Cause" -description "Unsupported repair combination including Local repair." -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($localCount -gt 1)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #we don't support more than one Local repair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Local: " + $localCount | convertto-xml | Update-DiagReport -id UnmanifestedRootCause -name "Unmanifested Root Cause" -description "Unsupported number of total Local repairs." -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $null;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #populate the parameter data.<br />
&nbsp;&nbsp;&nbsp; #NOTE: LUA repairs always are listed before<br />
&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elevation repairs (makes manifesting easier)<br />
&nbsp;&nbsp;&nbsp; $repairCount = $null;<br />
<br />
&nbsp;&nbsp;&nbsp; #guarantees that LUA repairs are placed before elevated<br />
&nbsp;&nbsp;&nbsp; $allRepairs = $LUARepairs + $elevateRepairs + $localRepairs;<br />
<br />
&nbsp;&nbsp;&nbsp; #lua repairs<br />
&nbsp;&nbsp;&nbsp; for($i=0; $i -lt $allRepairs.Length; $i++, $repairCount++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repair = $allRepairs[$i];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #get name and description of repair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #don't use DescriptionEx for unmanifested root causes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SplitString $repair.Description ([ref]$Name) ([ref]$Desc)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #add to outgoing param list<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Params.value.Add("RepairName"+$repairCount, $Name);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Params.value.Add("RepairDescription"+$repairCount, $Desc);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Params.value.Add("RepairID"+$repairCount, $repair.RepairID);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #add security boundary safe data<br />
&nbsp;&nbsp;&nbsp; $data = GetSBSData($Global:ndf.IncidentID)<br />
&nbsp;&nbsp;&nbsp; $params.value.Add("SBSData", $data)<br />
<br />
&nbsp;&nbsp;&nbsp; #keywords for escalation<br />
&nbsp;&nbsp;&nbsp; $keywords = GetKeywords($RootCause.DescriptionEx);<br />
&nbsp;&nbsp;&nbsp; if($keywords.Length -gt 0)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $params.value.Add("Keywords", $keywords);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if(($LUACount -eq 1) -and ($elevateCount -eq 1))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #return placeholder RC with mix of admin and LUA repairs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "{000000000-0000-0000-0000-000000000005}"<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($elevateCount -eq 1)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #return placeholder RC with single elevation repair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "{000000000-0000-0000-0000-000000000002}"<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($elevateCount -eq 2)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #return placeholder RC with two Admin repairs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "{000000000-0000-0000-0000-000000000004}"<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($LUACount -eq 1)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #check whether the single repair is info only or help topic to use alternate root cause<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repair = $LUARepairs[0];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #########<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try { $uiInfo = $repair.UiInfo; } catch{ $uiInfo = $null }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $repairFlags = $repair.Flags;<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(($uiInfo -and ($uiInfo.Type -eq $UIT_HELP_PANE)) -or ($repairFlags -band $RF_INFORMATION_ONLY))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #return placeholder RC with single info only or help topic repair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "{000000000-0000-0000-0000-000000000006}"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #return placeholder RC with single LUA repair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "{000000000-0000-0000-0000-000000000001}"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($LUACount -eq 2)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #return placeholder RC with two LUA repairs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "{000000000-0000-0000-0000-000000000003}"<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif($localCount -eq 1)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #return placeholder RC with a single Local user repair<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "{000000000-0000-0000-0000-000000000007}"<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $null;<br />
}<br />
<br />
function CreateCab($FileList, $TargetFolder, $TargetCAB)<br />
{<br />
<br />
$ddf = @"<br />
.OPTION EXPLICIT<br />
.Set CabinetNameTemplate=$TargetCAB<br />
.set DiskDirectoryTemplate=CDROM<br />
.Set CompressionType=MSZIP<br />
.Set UniqueFiles=`"OFF`"<br />
.Set Cabinet=on<br />
.Set DiskDirectory1=$TargetFolder<br />
$($OFS="`r`n"; $FileList)<br />
"@;<br />
<br />
&nbsp;&nbsp;&nbsp; $ddfFile = "NetworkConfiguration.ddf";<br />
<br />
&nbsp;&nbsp;&nbsp; $ddf | Out-File $ddfFile -Encoding Ascii;<br />
&nbsp;&nbsp;&nbsp; makecab /f $ddfFile;<br />
&nbsp;&nbsp;&nbsp; $succeeded = $?;<br />
&nbsp;&nbsp;&nbsp; #del $ddfFile;<br />
<br />
&nbsp;&nbsp;&nbsp; return $succeeded;<br />
}<br />
<br />
function HereString($text)<br />
{<br />
&nbsp;&nbsp;&nbsp; $here = "@'`n" + $text + "`n'@"<br />
&nbsp;&nbsp;&nbsp; return $here<br />
}<br />
<br />
#$Commands is an array of hash pairs&nbsp; "command": the command line to run, "file": the target filename,<br />
#appended to the end of the command line<br />
function AddCommandOutputToSession($Commands, $TargetCABName, $ReportHeader)<br />
{<br />
&nbsp;&nbsp;&nbsp; #lets create the temporary folder for all this data<br />
&nbsp;&nbsp;&nbsp; $tempFolder = [System.IO.Path]::GetTempFileName();<br />
&nbsp;&nbsp;&nbsp; del $tempFolder; #delete the file<br />
&nbsp;&nbsp;&nbsp; mkdir $tempFolder; #make it into a folder<br />
<br />
&nbsp;&nbsp;&nbsp; #go into the folder to avoid leaving side-effect files behind<br />
&nbsp;&nbsp;&nbsp; pushd $tempFolder;<br />
<br />
&nbsp;&nbsp;&nbsp; #run the commands in the list<br />
&nbsp;&nbsp;&nbsp; $fileList = @();<br />
&nbsp;&nbsp;&nbsp; $timeMeasure = @(); #keeps track of length of execution for commands<br />
&nbsp;&nbsp;&nbsp; foreach($item in $Commands)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #measure time it takes to execute commands<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $start = get-date<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $targetFile = $tempFolder + "\" + $item["file"];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $cmdline = $item["command"] + " " + (HereString $targetFile);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $err = $($out = Invoke-expression&nbsp; $cmdline) 2&gt;&amp;1;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!$err)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #the call succeeded, add the target file to the list to CAB<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $fileList += @($item["file"]);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $runtime = (get-date) - $start;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $timeMeasure += @(@{"command"=$item["command"];"runtime (ms)"=$runtime.TotalMilliseconds});<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #create a CAB of the files<br />
&nbsp;&nbsp;&nbsp; $start = get-date<br />
&nbsp;&nbsp;&nbsp; if(CreateCab ($fileList) (".\") ($TargetCABName))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $runtime = (get-date) - $start;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $timeMeasure += @(@{"command"="makecab.exe";"runtime (ms)"=$runtime.TotalMilliseconds});<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Update-DiagReport -ID NetworkData -name $ReportHeader -File ($tempFolder + "\"+ $TargetCABName)<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $timeMeasure | convertto-xml | Update-DiagReport -ID ConfigCollectionRuntime -Name "Data Collection Time" -Verbosity Debug<br />
<br />
&nbsp;&nbsp;&nbsp; popd;<br />
<br />
&nbsp;&nbsp;&nbsp; remove-item -recurse -force $tempFolder;<br />
}<br />
<br />
function AddNetworkInf<br />
<br />
ScriptBlock ID: e51aacde-e7b8-4366-bd80-0caf5c5b589a<br />
Path: C:\Users\Me\AppData\Local\Temp\SDIAG_d630b5e7-ff21-493c-98e2-b2ac45ea9525\UtilityFunctions.ps1
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="5" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sonya l  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Creating Scriptblock text (4 of 4):<br />
oToSession()<br />
{<br />
&nbsp;&nbsp;&nbsp; Write-DiagProgress -activity $localizationString.progress_Collecting_Config<br />
<br />
&nbsp;&nbsp;&nbsp; $commands = @(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @{"command"="ipconfig /all &gt;"; "file"="ipconfig.all.txt"};<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @{"command"="route print &gt;"; "file"="route.print.txt"};<br />
&nbsp;&nbsp;&nbsp; );<br />
<br />
&nbsp;&nbsp;&nbsp; AddCommandOutputToSession ($commands) ("NetworkConfiguration.cab") ($localizationString.OtherNetworkConfigReportName);<br />
<br />
&nbsp;&nbsp;&nbsp; Write-DiagProgress -activity " "<br />
}<br />
<br />
function GetUniqueFileName($IncidentID, $Operation)<br />
{<br />
&nbsp;&nbsp;&nbsp; #get temp folder location<br />
&nbsp;&nbsp;&nbsp; $tempFolder = get-childitem -path env:temp<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp; #strip { } at the ends of the incident ID GUID, generate file name<br />
&nbsp;&nbsp;&nbsp;&nbsp; $uniqueFileName = $tempFolder.Value+"\"+$IncidentID.Substring(1,$IncidentID.Length-2)+"." + $Operation<br />
<br />
&nbsp;&nbsp;&nbsp; #append whether it's admin or not (to avoid name clashes, as op count resets after elevation)<br />
&nbsp;&nbsp;&nbsp; $isAdmin = IsAdmin<br />
&nbsp;&nbsp;&nbsp; if($isAdmin)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $uniqueFileName += ".Admin";<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; #initialize or increment op count<br />
&nbsp;&nbsp;&nbsp; if($Global:OpCount -eq $null)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Global:OpCount = 0<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Global:OpCount++;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $uniqueFileName += "." + $Global:OpCount + ".etl";<br />
<br />
&nbsp;&nbsp;&nbsp; return $uniqueFileName<br />
}<br />
<br />
function AddTraceFileToSession($Ndf, $Name, $Operation)<br />
{<br />
&nbsp;&nbsp;&nbsp; #NDF flushes the trace file every time we query for it<br />
&nbsp;&nbsp;&nbsp; #A unique name needs to be generated each time we add the file to the report,<br />
&nbsp;&nbsp;&nbsp; #otherwise it will overwrite the existing ETL file<br />
&nbsp;&nbsp;&nbsp; #The naming convention is as follows:<br />
&nbsp;&nbsp;&nbsp; #&nbsp; IncidentID.Operation([Admin]).Counter.etl<br />
<br />
&nbsp;&nbsp;&nbsp; Write-DiagProgress -activity $localizationString.progress_Collecting_Logs<br />
<br />
&nbsp;&nbsp;&nbsp; $traceFile = $Ndf.TraceFile<br />
&nbsp;&nbsp;&nbsp; if($traceFile)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #get unique name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $newFileName = GetUniqueFileName $Ndf.IncidentID $Operation<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #rename file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; move "$traceFile" "$newFileName"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #add it to the report<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Update-DiagReport -ID NDFDebugLog -name $Name -File $newFileName<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #add HC events to the report<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddNewHCEventsToSession $newFileName<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # delete the file name edited by Claton<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #del "$newFileName"<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Name | convertto-xml | Update-DiagReport -id TraceFile -name "Trace File" -description "Failed while trying to retrieve the trace file for the session." -verbosity Debug<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; Write-DiagProgress -activity " "<br />
}<br />
<br />
function AddNewHCEventsToSession($TraceFile)<br />
{<br />
&nbsp;&nbsp;&nbsp; #we keep track of all the events added to the report, so we don't add duplicates (this function is called multiple times)<br />
&nbsp;&nbsp;&nbsp; if($Global:ReportEvents -eq $null)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Global:ReportEvents = @{};<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $script:ExpectingException = $false<br />
<br />
&nbsp;&nbsp;&nbsp; &amp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script:ExpectingException = $true<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $events = get-winevent -path $TraceFile -Oldest -FilterXPath "*[System[Provider[@Name='Microsoft-Windows-Diagnostics-Networking'] and (EventID=6100)]]" -ErrorAction SilentlyContinue<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $script:ExpectingException = $false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach($event in $events)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #events indexed by time they were emitted<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(($event -ne $null) -and !$Global:ReportEvents.ContainsKey($event.TimeCreated))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #Add helper class name to title so that it's easily distinguishable in the report without having to expand it<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $eventTitle = [System.String]::Format([System.Globalization.CultureInfo]::InvariantCulture, $localizationString.HelperClassEventNameWithHCName,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [System.Globalization.CultureInfo]::CurrentUICulture.TextInfo.ToTitleCase($event.Properties[0].Value));<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "&lt;Objects&gt;&lt;Object Type=""System.String""&gt;&lt;PRE&gt;&lt;![CDATA["+$event.Message +"]]&gt;&lt;/PRE&gt;&lt;/Object&gt;&lt;/Objects&gt;" | Update-DiagReport -id DiagInformation -name $eventTitle<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Global:ReportEvents.Add($event.TimeCreated, $event)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; trap [Exception]<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($script:ExpectingException)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "No admin helper class events were found." | convertto-xml | Update-DiagReport -id DiagEvents -name "Helper Class Events" -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Exception: " + $_.Exception.GetType().FullName + " Message: " + $_.Exception.Message&nbsp; | convertto-xml | Update-DiagReport -id DiagEventsFailure -name "Helper Class Events" -description "Failed while retrieving helper class events." -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function LoadResourceString($ResourceString)<br />
{<br />
&nbsp;&nbsp;&nbsp; [string]$bufStr = $null<br />
&nbsp;&nbsp;&nbsp; $dll = "NetworkDiagnosticSnapIn.dll"<br />
<br />
&nbsp;&nbsp;&nbsp; try<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RegSnapin $dll<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $bufferSize = 512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $buffer = New-Object System.Text.StringBuilder $bufferSize<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [Microsoft.Windows.Diagnosis.Network.NativeShellMethods]::SHLoadIndirectString($ResourceString, $buffer, $bufferSize, [IntPtr]::Zero)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $bufStr = $buffer.ToString()<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; finally<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnregSnapin $dll<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $bufStr<br />
}<br />
<br />
function IsDPSStarted()<br />
{<br />
&nbsp;&nbsp;&nbsp; $dpsService = get-service "DPS"<br />
&nbsp;&nbsp;&nbsp; if($dpsService)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($dpsService.Status -ne "Running")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $false;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $true;<br />
}<br />
<br />
function IsDPSDisabled()<br />
{<br />
&nbsp;&nbsp;&nbsp; $dpsService = gwmi win32_service -f "name='DPS'"<br />
&nbsp;&nbsp;&nbsp; if($dpsService)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($dpsService.StartMode -eq "Disabled")<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $true;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $false;<br />
}<br />
<br />
function IsSafeMode()<br />
{<br />
&nbsp;&nbsp;&nbsp; [void] [Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms")<br />
&nbsp;&nbsp;&nbsp; return [System.Windows.Forms.SystemInformation]::BootMode -ne 0<br />
}<br />
<br />
function IsHelpTopicAllowed($Link)<br />
{<br />
&nbsp;&nbsp;&nbsp; $regValue = get-itemproperty -path hklm:\SYSTEM\CurrentControlSet\Control\NetDiagFx\Config\HelpTopic&nbsp; -name $Link -ErrorAction SilentlyContinue -ErrorVariable regError<br />
&nbsp;&nbsp;&nbsp; if($regValue)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # check the DWORD value (the key to the value is the Value name: i.e., $Link)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - enabled<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # otherwise - disabled<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $filterValue = $regValue.$Link;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($filterValue -eq 1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $true;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $false;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif ($regError)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!($regError[0].CategoryInfo.Category -eq "InvalidArgument") -and&nbsp; !($regError[0].CategoryInfo.Category -eq "ObjectNotFound"))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; " Warning: Unexpected error when reading Help Topic Cause key : " + $regError[0].CategoryInfo.Category | convertto-xml | Update-DiagReport -id UnexpectedRegError -name "Unexpected Registry Error" -verbosity Debug<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $false;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
<br />
ScriptBlock ID: e51aacde-e7b8-4366-bd80-0caf5c5b589a<br />
Path: C:\Users\Me\AppData\Local\Temp\SDIAG_d630b5e7-ff21-493c-98e2-b2ac45ea9525\UtilityFunctions.ps1
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="6" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sonya l  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Just updating my situation here. Last night I went into GPE and disabled launching powershell scripts. I spent the last few hours in the registry blocking everything in the firewall (I'm not sure why so many things that I blocked in the firewall itself were
 still set to allow in the registry).</p>
<p>
</p><p>Before this last reboot on the desktop I discovered 1291 events for wmi activity, mainly errors deleting Group Policy extensions, extensions I have never touched, when searching the GUID in the registry these are under group policy extensions winlogon. These
 errors began after blocking everything "remote" in windows firewall. However I also have 68 events under Remote Assistance "Remote Assistance Com Server has started" and "Remote Assistance Com Server has ended" four of each event within a minute at random
 times, since May 1st... But all the remote services are disabled as previously stated.<a href="https://filestore.community.support.microsoft.com/api/images/c88b544a-071f-4b5a-910e-ab91e9f6d87c" target="_blank" rel="noreferrer nofollow"><img src="https://filestore.community.support.microsoft.com/api/images/c88b544a-071f-4b5a-910e-ab91e9f6d87c" /></a></p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="7" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> vicky acs  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>Hi Sonya,</p>
<p>
</p><p>
</p><p>You don't need to worry about .PBK files. <a href="https://social.technet.microsoft.com/Forums/en-US/d6bb5b27-f7d6-4f82-aef6-513a7441a753/make-a-pbk-connection?forum=winserverNIS" target="_blank" rel="noreferrer nofollow">
PBK's</a> are RAS phone book files. IP address 127.0.0.1 is for your <a href="https://technet.microsoft.com/en-us/library/cc958823.aspx" target="_blank" rel="noreferrer nofollow">
Local Host</a> which is your computer. </p>
<p>
</p><p>To know more about .PBK files and IP addresses, we encourage you to post your concern on
<a href="https://social.technet.microsoft.com/Forums/en-US/home?ppud=4" target="_blank" rel="noreferrer nofollow">
TechNet</a> forums for they have the necessary tools and in-depth knowledge about that matter.</p>
<p>
</p><p>
</p><p>Thank you.</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="8" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> vicky acs  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>Hi Sonya,</p>
<p>
</p><p>
</p><p>You don't need to worry about .PBK files. <a href="https://social.technet.microsoft.com/Forums/en-US/d6bb5b27-f7d6-4f82-aef6-513a7441a753/make-a-pbk-connection?forum=winserverNIS" target="_blank" rel="noreferrer nofollow">
PBK's</a> are RAS phone book files. IP address 127.0.0.1 is for your <a href="https://technet.microsoft.com/en-us/library/cc958823.aspx" target="_blank" rel="noreferrer nofollow">
Local Host</a> which is your computer. </p>
<p>
</p><p>To know more about .PBK files and IP addresses, we encourage you to post your concern on
<a href="https://social.technet.microsoft.com/Forums/en-US/home?ppud=4" target="_blank" rel="noreferrer nofollow">
TechNet</a> forums for they have the necessary tools and in-depth knowledge about that matter.</p>
<p>
</p><p>
</p><p>Thank you.</p>
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="9" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sonya l  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>224.0.0.22 is not my local computer though neither is 239.255.255.250. When I look up these Ip addresses (that are logged every time that .pbk is modified - same exact time down to the second) I find that 224.0.0.22 is a game router? Well I am not a gamer
 and I do not have any gaming hardware or software installed.</p>
<p>
</p><p>I have verified that it IS Microsoft - for whatever purposes. Yesterday I removed the files for rasphone - actually I removed the files and registry entries that which appeared when I searched rasphone in the registry. Rasdlg to be exact, this deactivated
 my windows. </p>
<p>
</p><p>In system properties it said that my windows is not activated and suggested I go online or call to activate. I attempted a system restore that did not fix the problem instead I had the watermark telling me that my windows is not valid. So I formatted the
 hard drive and did a clean install of windows with your March ISO (from microsoft's website). Anyway, after activation and the few updates I disconnected my ethernet and set the windows firewall to log connections and dropped packets then rebooted.
</p>
<p>
</p><p>On reboot it logged 224.0.0.22 and 239.255.255.250 as well as ::1 ff02: :16 each 4 times with 8 dropped packets on each line. Nothing but windows installed...</p>
        </p>
    <div id="pagerBottom" class="pager-container clearBoth">
        <div id="pagerBottomDesktop">
<meta name="awa-prevPage" content="1" />
<div>
            </span>
                        <span>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=security_&#38;_privacy">security_&#38;_privacy, </a> <br>
<a href="/search?q=pc">pc, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Results in Windows - Microsoft Community</title>
                        <span><a id="toggleFilterVisibility" role="button" class="c-hyperlink" tabindex="0">Show filters</a></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
<br><br>------------------------------------<br>
    <title>remote access code - Microsoft Community</title>
<h3> thomas_vu  say:</h3>
<h2>            remote access code</h2>
                    I am trying to make a call to the U.S. from my android device and was to input a remote access code. I never had to input this. How do I get this remote access code?
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> josephv_a  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p><span>Hello Thomas_Vu,
</span></p>
<p><span>&nbsp;</span></p>
<p><span>&nbsp;</span></p>
<p><span>To better assist you, kindly provide the following:
</span></p>
<p><span>&nbsp;</span></p>
<p><span>*Please
<strong>elaborate what remote access code</strong> you are referring to. </span></p>
<p><span>&nbsp;</span></p>
<p><span>*Are you trying to
<strong>call a Skype contact or</strong> <strong>a landline/mobile number</strong>?
</span></p>
<p><span>&nbsp;</span></p>
<p><span>*Kindly
<strong>provide a screenshot</strong> of the message you are getting. </span></p>
<p><span>&nbsp;</span></p>
<p><span>&nbsp;</span></p>
<p><span>Looking forward to your reply.</span></p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> thomas_vu  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            I used my Android phone to make a call to a landline/mobile number in the U.S. I have a monthly subscription with Skype. I have always my phone to make call not my computer. I have never got ask for this "remote access code".
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> noevir_l  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>
</p><blockquote>I used my Android phone to make a call to a landline/mobile number in the U.S. I have a monthly subscription with Skype. I have always my phone to make call not my computer. I have never got ask for this
 "remote access code". </blockquote>
<p>
</p><p><span style="color: rgba(0, 0, 0, 1)">Hi,
</span></p>
<p><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span></p>
<p><span style="color: rgba(0, 0, 0, 1)">If you’re using
<a href="https://support.skype.com/en/faq/FA10950/what-is-a-skype-to-go-access-number?q=access+number" target="_blank" rel="noreferrer nofollow">
</span></p>
<p><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span></p>
<p><span style="color: rgba(0, 0, 0, 1)">You mentioned that you’ve never tried entering a “remote access code” which I believe you’re referring to the Skype-To-Go’s Access
 number. I therefore concluded that you’re probably typing/dialing a number on your mobile phone’s dialpad not on the Skype app.
</span></p>
<p><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span></p>
<p><span style="color: rgba(0, 0, 0, 1)">Hence, I strongly advise you to sign in to Skype app first and dial the number that you’re trying to reach and let me know of the
 results. </span></p>
<p><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span></p>
<p><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span></p>
<p><span style="color: rgba(0, 0, 0, 1)">I look forward to your response.
</span></p>
        </p>
<a href="/search?q=skype">skype, </a> <br>
<a href="/search?q=&#40;archived&#41;_skype_for_android">&#40;archived&#41;_skype_for_android, </a> <br>
<a href="/search?q=calling">calling, </a> <br>
<a href="/search?q=audio_and_video">audio_and_video, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>i can&#39;t play any games i bought on my account even though i&#39;m - Microsoft Community</title>
<h3> captainokin  say:</h3>
<h2>            i can&#39;t play any games i bought on my account even though i&#39;m signed in</h2>
                    <p>whenever i try to start up any game that is not on a disc i get the euro saying the&nbsp;account that bought it has to be signed in. The only account on my xbox is the one that bought all the games.</p><p>what do i do i tried hard reseting my xbox and it still doesn't work.&nbsp;</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Geth" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display blue288 avatar-size-extrasmall"; this.setAttribute("alt", "GE"); this.style="display: inline-block";'
<h3> geth  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>When you go to the store does it show the game being purchased?</p><p>Also, did you get a confirmation email on the purchase?</p>
        </p>
<a href="/search?q=gaming_and_xbox">gaming_and_xbox, </a> <br>
<a href="/search?q=games_and_gaming">games_and_gaming, </a> <br>
<a href="/search?q=xbox_series_x&#124;s_and_xbox_one">xbox_series_x&#124;s_and_xbox_one, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>edge keeps shutting down - Microsoft Community</title>
<h3> darrellhenderson  say:</h3>
<h2>            edge keeps shutting down</h2>
                    <p>Edge has never worked correctly on my computer. How can I re-install it so that it works?</p>
<p>I currently have to use chrome to surf the web.</p>
<p>I would like to at least use Edge to compare the two browsers.</p>
<p>Thanks</p>
<p>D</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall" title="Inactive profile" role="img">
<h3> a. user  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p><span><span>Hi Darrell,</span></span></p>
<p>
</p><p><span><span>Welcome to Microsoft Community. Your interest in Windows 10 is much appreciated.</span></span><span><span>&nbsp;</span></span></p>
<p>
</p><p><span><span>I would suggest you to try the below methods and check if the Edge works fine:</span></span></p>
<p>
</p><p><span><strong><span>Method 1:</span></strong></span></p>
<p><span style="color: rgba(51, 51, 51, 1)">I suggest you clear the <strong>Clear browsing data option
</strong>of Microsoft Edge and check if you face the issue. To do so perform the steps below.</span></p>
<ol>
<li><span style="color: rgba(51, 51, 51, 1)">Click on the <strong>More actions</strong> icon next to the feedback icon present on top right corner of the Edge.</span></li><li><span style="color: rgba(51, 51, 51, 1)">Select <strong>Settings</strong> and click on <strong>
Choose what to clear.</strong></span></li><li><span style="color: rgba(51, 51, 51, 1)">Check the boxes <strong>Browsing history, Cookies and saved website data and Cached data and files
</strong>and click on <strong>Clear.</strong></span></li></ol>
<p><span><strong><span>Method 2:</span></strong></span></p>
<p><span style="color: rgba(51, 51, 51, 1)">If you are using any Proxy connection, then try disabling the proxy connection and check.</span></p>
<p><span style="color: rgba(51, 51, 51, 1)">Follow the steps to disable proxy:</span></p>
<ol>
<ul>
<ul>
<ol>
<ol>
<ol>
<li>
<p style="color: rgba(0, 0, 0, 1)"><span style="color: rgba(51, 51, 51, 1)">Click the <strong>Settings</strong> icon at the top right corner in internet explorer.</span></p>
</li><li>
<p style="color: rgba(0, 0, 0, 1)"><span style="color: rgba(51, 51, 51, 1)">Click the <strong>Tools </strong>
button, and then click <strong>Internet Options</strong>.</span></p>
</li><li>
<p style="color: rgba(0, 0, 0, 1)"><span style="color: rgba(51, 51, 51, 1)"><span>&nbsp;</span>Click the <strong>
Connections</strong> tab, and then click <strong>LAN settings</strong>.</span></p>
</li><li>
<p style="color: rgba(0, 0, 0, 1)"><span style="color: rgba(51, 51, 51, 1)">Uncheck the box next to “<strong>proxy server for your LAN</strong>”.</span></p>
</li><li>
<p style="color: rgba(0, 0, 0, 1)"><span style="color: rgba(51, 51, 51, 1)">Click on <strong>OK</strong> to save the setting and close window.</span></p>
</li></ol>
</ol>
</ol>
</ul>
</ul>
</ol>
<p><span style="color: rgba(51, 51, 51, 1)">Now check the issue by opening Edge.</span></p>
<p>
</p><p><strong><span style="color: rgba(51, 51, 51, 1)">Method 3:</span></strong></p>
<p><span style="color: rgba(51, 51, 51, 1)">Follow the below steps:</span></p>
<p><span style="color: rgba(51, 51, 51, 1)">•Open <strong>PowerShell as administrator.</strong></span></p>
<p><span style="color: rgba(51, 51, 51, 1)">•Run the command </span></p>
<p><strong><span style="color: rgba(51, 51, 51, 1)">Get-AppXPackage | Foreach {Add-AppxPackage -DisableDevelopmentMode -Register "$($_.InstallLocation)\AppXManifest.xml"}</span></strong></p>
<p>
</p><p><span><span>Keep us posted if you face any issues on windows in future. We will be glad to help you.</span></span></p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> darrellhenderson  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>None of the options worked. The program does not stop long enough before shutting down for me to get to the settings.&nbsp;</p>
<p>Is there a way to remove the edge program and re install it from scratch?</p>
<p>This program is in an endless loop.</p>
<p>
</p><p />
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> jsmith38  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Sadly, no. Edge and Cortana are the worse things to ever hit the internet. You can't disable either without changing registry keys. I never, ever open edge, yet there are 100 "privacy issues" from Edge when I run ASC Pro. I have IE disabled, but that is
 simply an illusion by MS. I have the setting set to not accept website caches, cache size to minimum of 8, and never check for newer versions of webpages, yet, it's a waste of time.&nbsp;</p>
<p>Microsoft has become worse than Google, as far as user options and privacy are concerned.&nbsp;</p>
<p>If I open Edge to "clear history" (and I have every box checked), as soon as I click "clear history", it shuts down. Was fine until latest update.&nbsp;</p>
<p>Never been a Mac fan, but I have ordered 2 Macs. Cannot wait to trash this once great OS.&nbsp;</p>
<p>All you will ever, ever get in these MS forums are copy and paste responses to anything. Check through them, and you'll notice that no one, EVER, has had their problem solved by coming here. Try hack sites. They will give you the info to "fix" the **** MS
 is forcing people to use.&nbsp;</p>
        </p>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=network_&#38;_internet">network_&#38;_internet, </a> <br>
<a href="/search?q=pc">pc, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>How to change RDP Port - Microsoft Community</title>
<h3> marioherrera2  say:</h3>
<h2>            How to change RDP Port</h2>
                    <span>How to change RDP Port, from 3389 to another port.</span>
                    <span>How to change RDP Port, from 3389 to another port.</span>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-small circular-display" role="img"
           title="Greg Carmack - Windows MVP 2010-2020" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display purple526 avatar-size-small"; this.setAttribute("alt", "GC"); this.style="display: inline-block";'
<h3> greg carmack - windows mvp 2010-2020  say:</h3>
<ul class="message-user-info-affiliations-list">
    </ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Hi Mario.  I'm Greg, an installation specialist and 9 year Windows MVP, here to help you.  
<br />
<br />See here:  <a href="https://tweaks.com/windows/50743/change-remote-desktop-rdp-port/" target="_blank" rel="noreferrer nofollow">https://tweaks.com/windows/50743/change-remote-...</a>
<br />
<br />I hope this helps.  Feel free to ask back any questions and let us know how it goes.  I will keep working with you until it's resolved.  
<br />
<br />________________________________________________________
<br />Standard Disclaimer:   There are links to non-Microsoft websites. The pages appear to be providing accurate, safe information. Watch out for ads on the sites that may advertise products frequently classified as a PUP (Potentially Unwanted Products). Thoroughly research any product advertised on the sites before you decide to download and install it.       
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=network_and_internet">network_and_internet, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>MSIMG32.dll - Microsoft Community</title>
<h3> sally gordon mark  say:</h3>
<h2>            MSIMG32.dll</h2>
                    <p>Hello,</p>
<p>I disinstalled Movie Maker because it was making my computer crash every 15 minutes, and I wanted to reinstall the program because I am in the middle of an urgent project.&nbsp;</p>
<p>When I tried to install a newer version, my computer crashed again.</p>
<p>Since, every time I turn on the computer, no matter what I want to do, I get the message that MSIMG32.dll is missing. I don't want to download dll files from other companies since they all seem to be malware, but I don't find anything simple on the Microsoft
 site.</p>
<p>Please help if you can. This is urgent for my work.</p>
<p>
</p><p>Thank you,</p>
<p>Sally Gordon-Mark</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Andre Da Costa" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display blue286 avatar-size-extrasmall"; this.setAttribute("alt", "AD"); this.style="display: inline-block";'
<h3> andre da costa  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Windows Essentials, which includes Movie Maker is not longer certified compatible with Windows 10. Microsoft ended support in January of 2017. 
<br />
<br />Where exactly are you installing Movie Maker from, are you installing it as part of Windows Essentials?
<br />
<br />Windows Essentials latest version 16.4.3528.0331:
<br />
<br />English (United Kingdom)
<br />
<br /><a href="http://web.archive.org/web/20160423192125/http://wl.dlservice.microsoft.com/download/1/9/4/194B1919-A211-441F-BC0E-34F6B533B876/en-gb/wlsetup-all.exe" target="_blank" rel="noreferrer nofollow">http://web.archive.org/web/20160423192125/http:...</a>
<br />
<br />English (United States)
<br />
<br /><a href="http://web.archive.org/web/20170112124505/http://wl.dlservice.microsoft.com/download/C/1/B/C1BA42D6-6A50-4A4A-90E5-FA9347E9360C/en/wlsetup-all.exe" target="_blank" rel="noreferrer nofollow">http://web.archive.org/web/20170112124505/http:...</a>       
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sally gordon mark  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>Hi,</p>
<p>i still am not sure what to do. Yesterday, I went to the Microsoft site and found Movie Maker for Windows 10. there was no mention of Essentials. If Windows 10 doesn't support Essentials anymore, how can I use it? Is there any free software available for
 Windows 10 to make a slideshow with music, si I can finish my project?</p>
<p>thank you,</p>
<p>
</p><p>sally</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Andre Da Costa" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display blue286 avatar-size-extrasmall"; this.setAttribute("alt", "AD"); this.style="display: inline-block";'
<h3> andre da costa  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Point me to this link let me check it please. 
<br />
<br />You can install Windows Essentials with Movie Maker, its just not supported, but it works.       
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="3" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sally gordon mark  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>Hi Andre,</p>
<p>
</p><p>The link to the page I was trying to download from (I live in France):</p>
<p>
</p><p>&nbsp;https://www.microsoft.com/fr-fr/store/p/movie-maker-free/9mvfq4lmz6c9?SilentAuth=1&amp;wa=wsignin1.0</p>
<p>
</p><p>I will try installing Windows Essentials.</p>
<p>
</p><p>What about the missing MSIMG32.dll?</p>
<p>
</p><p>Thank you,</p>
<p>
</p><p>Sally</p>
<p>
</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="4" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sally gordon mark  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>Hi Andre,</p>
<p>
</p><p>I installed Windows Essential with Movie Maker from the link you gave me and then got the message again about the missing MSIMG32.dll.</p>
<p>
</p><p>I appreciate your help, but I am beginning to hate Windows with a passion. I wish I had bought a Mac at the beginning. I will give you a good rating for helping me, but Microsoft is going to lose a customer.</p>
<p>
</p><p>Sally</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="5" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Andre Da Costa" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display blue286 avatar-size-extrasmall"; this.setAttribute("alt", "AD"); this.style="display: inline-block";'
<h3> andre da costa  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Which version of Windows 10 is currently installed? See how to verify:
<br />
<br /><a href="https://answers.microsoft.com/en-us/windows/wiki/windows_10-windows_install/how-to-verify-if-you-downloaded-or-installed-the/06f98274-741a-45df-9e0d-6cc48816824b">https://answers.microsoft.com/en-us/windows/wik...</a>
<br />
<br />Which version and edition Windows did you originally upgrade from or was installed prior to your current version:
<br />
<br />Windows 10 - 1703, 1607, 1511, 1507 (build 10240)
<br />
<br />Windows 7 Starter, Home Basic, Home Premium, Windows 8.0 Core, Windows 8.1 Windows 7 Professional, Windows 7 Ultimate, Windows 8.0 Pro, Windows 8.1 Pro       
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="6" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sally gordon mark  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            I have Windows Version 1703 now. I believe that the original version was a basic 7 or 8 (sorry I don't remember).
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="7" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sally gordon mark  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            To clarify: I have Windows 10 version 1703 now, the 1709 update has been trying to make itself happen, but fails, although I keep the computer on.
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="8" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sally gordon mark  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Sorry, I just noticed on my computer that it says Windows 7. It must have been the Home Basic one.
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="9" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Andre Da Costa" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display blue286 avatar-size-extrasmall"; this.setAttribute("alt", "AD"); this.style="display: inline-block";'
<h3> andre da costa  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Strange, it should work on Windows 10 1703 just fine. 
<br />
<br />Open Start
<br />Type: cmd
<br />Right click CMD
<br />Click Run as administrator
<br />
<br />At the command prompt, type:
<br />net user administrator /active:yes
<br />
<br />Hit Enter
<br />
<br />Close command prompt, restart, then try signing into the Administrator account.
<br />
<br />Try running the file again.       
        </p>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=performance_and_system_failures">performance_and_system_failures, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Communication ban, done nothing&#63; - Microsoft Community</title>
<h3> firencze 17 i  say:</h3>
<h2>            Communication ban, done nothing&#63;</h2>
                    <p>I got a communication ban on my account: Firencze 17 i but i haven't done anything wrong? I called some one 'dumb' for insulting me,&nbsp;using a headset so I texted this person and now im the one who got banned?????</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="no-replies-section">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=gaming_and_xbox">gaming_and_xbox, </a> <br>
<a href="/search?q=devices_and_networking">devices_and_networking, </a> <br>
<a href="/search?q=xbox_series_x&#124;s_and_xbox_one">xbox_series_x&#124;s_and_xbox_one, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>PowerShell Initializing Error - Microsoft Community</title>
<h3> darkdeveloper  say:</h3>
<h2>            PowerShell Initializing Error</h2>
                    <p>I am trying to initialize PowerShell in the command prompt by typing</p>
<p>C:\&gt;powershell</p>
<p>&nbsp;</p>
<p>An error displays saying:</p>
<p>&nbsp;</p>
<p>The shell cannot be started. A failure occurred during initialization:</p>
<p>The type initializer for 'System.Management.Automation.LanguagePrimitives' threw</p>
<p>&nbsp;an exception.</p>
<p>&nbsp;</p>
<p>I have uninstalled and installed Windows Management Framework Core. System.Management.Automation.dll is in the C:\WINDOWS\assembly folder. I have installed and initialized PowerShell on a few hundred other computers using the same base image as this particular
 one. Does anyone know a fix or where (if) I can see where the exception handling problem is?</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-small circular-display" role="img"
           title="Debbie_H" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display magenta241 avatar-size-small"; this.setAttribute("alt", "DE"); this.style="display: inline-block";'
<h3> debbie_h  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Hi DarkDeveloper,</p>
<p>The issue you've posted would be better suited in our <a href="http://social.technet.microsoft.com/Forums/en-us/categories" target="_blank" rel="noreferrer nofollow">
TechNet Forums</a>, Resources for IT Professionals.&nbsp; </p>
<p>Thanks!</p>
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>how do I get my homegroup to recognize me ipad&#63; - Microsoft Community</title>
<h3> harvey moxness  say:</h3>
<h2>            how do I get my homegroup to recognize me ipad&#63;</h2>
                    I have a home network, working on wi-fi, so that I can share files and my printer, It works fine and recognizes my 2 lap top pcs and my desktop pc, all running on Windows 7. I just bought an ipad, which works on the wi-fi, but my "homegroup" doesn't include
 the ipad. I want my homegroup to recognize my ipad, so it can use my printer. How do I get my homegroup to recognize my ipad?
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-small circular-display" role="img"
           title="Al Jarvi" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display magenta241 avatar-size-small"; this.setAttribute("alt", "AJ"); this.style="display: inline-block";'
<h3> al jarvi  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>HomeGroup is only valid between Windows 7 computers...</p>
<p>I would post to the appropriate Apple iPad forum for help with apps that may allow access to shared files on your network and network printers.</p>
<p><a href="http://www.apple.com/support/ipad/" target="_blank" rel="noreferrer nofollow">http://www.apple.com/support/ipad/</a></p>
<p>Personally I use <strong>SkyDrive</strong> to share files between my Windows 7 computers and an iPod Touch (4th gen).</p>
<p><a href="https://apps.live.com/skydrive" target="_blank" rel="noreferrer nofollow">https://apps.live.com/skydrive</a></p>
<p>iCloud may also be an option for you...</p>
<p><a href="http://www.apple.com/support/icloud/" target="_blank" rel="noreferrer nofollow">http://www.apple.com/support/icloud/</a></p>
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_7">windows_7, </a> <br>
<a href="/search?q=network_&#38;_internet">network_&#38;_internet, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>unable to sign in - Microsoft Community</title>
<h3> viola stoicovici  say:</h3>
<h2>            unable to sign in</h2>
                    I am unable to sign in&nbsp; to access SKYPE, changed password several times but I still get the message "unable to sign in". However I am able to sign in to access my Microsoft account
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> erika.esperanza  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> julie_s1  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>Hi All,</p>
<p>
</p><p>To further investigate, what is your device's operating system and the exact version of Skype you are using? Have you tried using a different internet connection?</p>
<p>
</p><p>Any additional information will help us resolve the issue. If you have further questions, please do not hesitate to reply to this post.
<br />
Thank you!<br />
&nbsp;<br />
&nbsp;<br />
Julie_S1<br />
Skype Community Moderator</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> juansilva3  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            I am using Windows 7. I can access online but I cannot access skype on my Samsumg S8+. I have the latest version of skype from the google play store.
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="3" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> erika.esperanza  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>I also have the latest version of Skype (or at least I think it is because when I couldn't access it I removed from my mobile and tried to download it again). Its number is: 7.46.0.596</p>
<p>I have a Huawei P8 Lite with an android version of 5.0.1</p>
<p>Yesterday I was able to sign in through a different wi-fi connection (though I tried 2 the previous day - at home and at work)</p>
<p>
</p><p>Ty for the reply.</p>
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="4" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> julie_s1  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>Hi All,</p>
<p>
</p><p>Please try to uninstall and reinstall Skype. Ensure to clear the data and restart your device before reinstalling.</p>
<p>
</p><p>Update us on what will happen.</p>
<p>Thanks!</p>
<p>
</p><p>
</p><p>Julie_S1<br />
Skype Community Moderator</p>
        </p>
<a href="/search?q=skype">skype, </a> <br>
<a href="/search?q=skype_for_android">skype_for_android, </a> <br>
<a href="/search?q=getting_started">getting_started, </a> <br>
<a href="/search?q=sign_in">sign_in, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Keyboard randomly disconnecting frequently - Microsoft Community</title>
<h3> system32bitt  say:</h3>
<h2>            Keyboard randomly disconnecting frequently</h2>
                    <p>I just built a new PC, and after using it for about 2 days, the keyboard disconnects and reconnects at random times, and if i'm playing games, the keys will stick until I press the key being held down again. I don't have sticky keys enabled and I updated
 the motherboard drivers as well as the keyboard (if that exists) I also tried switching USB ports, to no avail.</p>
<p>
</p><p>Specs:</p>
<p>
</p><p>CPU: AMD FX-8350</p>
<p>
</p><p>Graphics Card: GTX 1060 3 GB</p>
<p>
</p><p>Motherboard: ASUS M5A78L-M PLUS/USB3</p>
<p>
</p><p>RAM: 8 GB DDR3</p>
<p>
</p><p>OS: Windows 10 Pro Build 17763</p>
<p>
</p><p>Keyboard: Redragon Kumara k552r </p>
<p>
</p><p>Any help would be appreciated.</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-small" role="img"
<h3> bill.p.  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Hi System, I'm Graeme, an independent adviser here to help.
<br />
<br />That sounds like it's a faulty connection inside the keyboard, but I'll just give you a couple other things to try before getting the keyboard repaired:
<br />
<br />Firstly, I would see if the troubleshooter fixes the issue. Click Start and type "troubleshoot" then select the first result. Scroll down and choose Keyboard. Run the troubleshooter, and see if it helps.
<br />
<br />Otherwise, try reinstalling the keyboard through Device Manager:
<br />
<br />- Press Windows Key+X and choose Device Manager.
<br />- Find your keyboard in the list.
<br />- Right-click it and choose Update Driver.
<br />- If that doesn't work, try uninstalling it and then scan for hardware changes to reinstall the driver.
<br />
<br />Also, try using the keyboard with another PC if you have one, to see if the issue persists. If it does, you'll know it's definitely a fault with the keyboard.
<br />
<br />Please let me know how you go! Thanks!       
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=devices_and_drivers">devices_and_drivers, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>surface rt and adobe flash version 11.3 - Microsoft Community</title>
<h3> ecurtis24  say:</h3>
<h2>            surface rt and adobe flash version 11.3</h2>
                    will the surface rt ever be updated to flash 11.8?<br />
i bought a surface rt for use while in nursing school and the online materials are not all viewable with the surface rt.<br />
a specific piece that i can't view is on http://evolvels.elsevier.com<br />
the flashcards can't be viewed on the surface rt but can be viewed on my laptop.<br />
is this on the black list or is just not viewable because of the older verion of flash?<br />
i tried updating my whitelist but that didn't seem to work.<br />
thanks for your help<br />
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> geethu b  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p><font><font color="#000000"><font>Hi Ecurtis,</font></font></font></p>
<p><font color="#000000">&nbsp;</font></p>
<p><font><span style="color: rgba(0, 0, 0, 1)">Adobe Flash Player comes pre-installed with Internet Explorer 10 and
<b>any updates that are distributed is via Windows standard update mechanisms</b>.
</span></font><span style="color: rgba(51, 51, 51, 1)"><font>In order to update Adobe Flash player you must use
</font><a href="http://windows.microsoft.com/en-IN/windows-8/windows-update-faq" target="_blank" rel="noreferrer nofollow"><font color="#0072c6">Windows updates</font></a><font>.</font></span></p>
<p><span style="color: rgba(51, 51, 51, 1)"><br />
<br />
<font><font>You may also check if there are any latest updates or plug-ins available for Adobe Flash Player.</font></font></span></p>
<font color="#000000"><br />
</font>
<p><span style="color: rgba(51, 51, 51, 1)"><font><font>a.
<b>Right-click</b> on <b>Start button.</b></font></font></span></p>
<p><span style="color: rgba(51, 51, 51, 1)"><font><font>b. Click on
<b>Control Panel</b>.</font></font></span></p>
<p><span style="color: rgba(51, 51, 51, 1)"><font><font>c. Select
<b>Large icons</b> under <b>view by option</b> on the <b>top right corner</b>.</font></font></span></p>
<p><span style="color: rgba(51, 51, 51, 1)"><font><font>d.
<b>Double-click</b> Adobe Flash Player.</font></font></span></p>
<p><span style="color: rgba(51, 51, 51, 1)"><font><font>e. Click on
<b>Advanced Tab.</b></font></font></span></p>
<p><span style="color: rgba(51, 51, 51, 1)"><font><font>f. Click on
<b>Check Now</b> button.</font></font></span></p>
<p><span style="color: rgba(51, 51, 51, 1)"><font><font>g. Follow the instructions.</font></font></span></p>
<p><span style="color: rgba(51, 51, 51, 1)"><font>&nbsp;</font></span></p>
<p><span style="color: rgba(0, 0, 0, 1)"><font><font>Hope this information helps. Reply to the post with updated status of the issue to assist you further.</font></font></span></p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> ecurtis24  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            I have tried the directions and when I get to the Advanced Tab I can't select Check Now.<br />
Check now is gray and beside it says "Plug-in Version: Not Installed"<br />
<br />
The option "notify me to install updates" is selected and I can't change that either.<br />
Thanks<br />
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> ecurtis24  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            i have done all the windows updates and now it seems to work just fine, thanks for your help.<br />
the surface rt is a great buy for the money!!!!<br />
<br />
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="3" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> geethu b  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p><span><font color="#000000">Hi
<font>Ecurtis</font>,</font></span></p>
<p>&nbsp;</p>
<p><span><font color="#000000">Good to know that your issue is resolved. Please feel free to reply, in case if you need any further
 assistance or information on this issue.</font></span></p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="4" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> tom cawley  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            I got up to the advance tabs but the updates are shaded gray and I can not click on anything
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="5" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> geethu b  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Hi Tom,</p>
<p>
</p><p>I would suggest you to download and install all the available Windows Updated including the optional updates. Check if it helps.</p>
<p>
</p><p><span style="color: rgba(0, 0, 0, 1)">Hope this information helps. Reply to the post with updated status of the issue to assist you further.</span></p>
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="6" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> morgandear  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Hi I have a windows rt it is 32gb (tablet)&nbsp;it says when I got to watch TV nz on demand or go on photo websites that I need to install an adobe flash player but mine is a tablet how do I do this??? Please let me no as my tablet is not now working</p>
<p>
</p><p>Also my tablet has uninstalled 2 apps one is Skype witch I need and now no longer have and I can't remember
</p>
        </p>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_rt">windows_rt, </a> <br>
<a href="/search?q=network_&#38;_internet">network_&#38;_internet, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Epson XP-750 only printing part of the picture from Lightroom4 &#38; - Microsoft Community</title>
<h3> larsalterg&#229;rd  say:</h3>
<h2>            Epson XP-750 only printing part of the picture from Lightroom4 &#38; CS4</h2>
                    <p><span>I have just purchased an Epson Expression Photo XP-750. It does only print one quater of a page from Lightroom 4.4. Same result printing from CS4. OS is Win 8.1 64bit. Export the picture to jpeg and print from windows
 native photo viewer works just great. With or without border. Have tried Epson driver 7.01 (win 7) &amp; 7.02 (win 8) but it make no sense.&nbsp;</span></p>
<p><span>Whatever settings I try windows return an error message&nbsp;</span>"Error - sent to printer".</p>
<p>Best looking print is with settings: Color Control: Epson Std. Color management by printer. Rather large border. Still printed with an error massage.</p>
<p>Best photo option Photo RPM (Max dpi) is not working at all.&nbsp;Could it be some network related issue? Printer and PC is wired to an Asus RT-N66U router. Printing of docs &amp; pictures works well from non Adobe apps. Is it a win8.1 issue?</p>
<p><br />
</p>
<p>Epson support was very rapid to respond, but claim pc settings, os or adobe or a combination to be the source of failure.</p>
<p><br />
</p>
<p>I was hoping to get a decent budget AIO working in our home environment and at the same time fit into my photo workflow with a bit of control of the printout. Exporting to jpeg and print from windows is no great option.</p>
<p><span>If there is no solution, I have to consider return the printer.&nbsp;</span></p>
<p><span><br />
</span></p>
<p><br />
</p>
<p><br />
</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> sweetyluv  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <span><font color="#000000">The issue is not with the printer or Microsoft as you are able to print all the documents fine. There might be some issues within Lightroom4 &amp; CS4.
 So contact that manufacturer.</font></span>
        </p>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_8.1">windows_8.1, </a> <br>
<a href="/search?q=devices_&#38;_drivers">devices_&#38;_drivers, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Bitlocker stuck in paused state - Microsoft Community</title>
<h3> drewmo2000  say:</h3>
<h2>            Bitlocker stuck in paused state</h2>
                    <p>Just reloading a 4year old Dell laptop I was given. Fresh Windows 7 load. I don't have the bitlocker PIN or PW. I wanted to decrypt the drive so that bitlocker is completely disabled. Went into the Control panel&gt;manage bitlocker and started decryption process.
 So far so good. Then the computer went into hibernation. Go into the panel now, and it says&nbsp; 'Decryption paused'. No active buttons or links visible to allow it to resume.
</p>
<p>
</p><p>So, I go into elevated CMD, type&nbsp; 'manage-bde -status'. It tells me:</p>
<p>Conversion status: Decryption <strong>paused</strong></p>
<p>Percentage Encrypted: 13%</p>
<p>Encryption method:&nbsp; AES256 with diffuser</p>
<p>Protection status: Protection off</p>
<p>Lock status: Unlocked</p>
<p>Identification field: None</p>
<p>Key protectors:</p>
<p>&nbsp;&nbsp; Numerical password</p>
<p>&nbsp;&nbsp; TPM and PIN</p>
<p>
</p><p>Ok, so now I try 'manage-bde -resume c:'</p>
<p>It now says Decryption now in progress. Woohoo!!!</p>
<p>
</p><p>But it is lying... </p>
<p>
</p><p>Half an hour later the status is still the same - says Decryption paused at 13%. The Windows 'control panel/manage bitlocker' still show decryption paused. I've tried restarting, and repeating, no luck.</p>
<p>
</p><p>Help! Anyone any ideas on how I can restart the decryption process?</p>
<p>
</p><p>The thing that worries is me is that sometime back (on another computer) I had an issue due to some update event that tinkered with the BIOS, which then triggered the inactive bitlocker to engage (I hadn't decrypted the drive, just suspended bitlocker).
 Luckily, for that computer I had the PIN. (I then decrypted it to prevent this happening again). But if that happens on this one, I'm screwed, hence my desire to decrypt it before I start using it. I'm only doing this to give me a spare computer for my kids
 to play with, its a fresh build, so if necessary, I guess I could completely reload without too much hassle, but hope it doesn't come to that...</p>
<p>
</p><p><em>[Moved from: Windows / Windows 7 / Other Windows apps]</em></p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-small" role="img"
<h3> arjay dom  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>Hi,</p>
<p>
</p><p>You issue with drive decryption will require some advanced troubleshooting steps to be resolved. For better assistance or guidance in resolving the issue, we recommend posting your concern on<span>&nbsp;</span><strong><a href="https://social.technet.microsoft.com/forums/en-us/home" target="_blank" rel="noreferrer nofollow">TechNet</a></strong>.</p>
<p>
</p><p><span>Feel free to post back if you have other concerns.</span></p>
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_7">windows_7, </a> <br>
<a href="/search?q=security_and_privacy">security_and_privacy, </a> <br>
<a href="/search?q=security_and_privacy">security_and_privacy, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>how to give full permission to system32 using Registry - Microsoft Community</title>
<h3> livecode  say:</h3>
<h2>            how to give full permission to system32 using Registry</h2>
                    <p>Hi...</p>
<p>go to this below link</p>
<p><a href="http://www.powercomars.com/docs/powercom_vista_and_office_2007_compatibility/how_to_set_windows_system32_permission_in_vista.htm" target="_blank" rel="noreferrer nofollow">http://www.powercomars.com/docs/powercom_vista_and_office_2007_compatibility/how_to_set_windows_system32_permission_in_vista.htm</a></p>
<p>here you will find how to give permission to system32 folder i do this steps work fine but i need to do the above same using Registry can it be possible?</p>
<p>How to do using Registry..?</p>
<p>Thanks</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-small circular-display" role="img"
           title="dax1792" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display purple526 avatar-size-small"; this.setAttribute("alt", "DA"); this.style="display: inline-block";'
<h3> dax1792  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>If I understand your question correctly, you are asking how to edit the Registry to change the permissions on the System32 folder.</p>
<p>File permissions are not stored in the registry, so this cannot be accomplished.</p>
<p>&nbsp;</p>
<p>The other way to change file permissions is using the takeown and icalcs commands.</p>
<p><a href="http://technet.microsoft.com/en-us/library/cc753024(WS.10).aspx" target="_blank" rel="noreferrer nofollow">http://technet.microsoft.com/en-us/library/cc753024(WS.10).aspx</a></p>
<p><a href="http://technet.microsoft.com/en-us/library/cc753525(WS.10).aspx" target="_blank" rel="noreferrer nofollow">http://technet.microsoft.com/en-us/library/cc753525(WS.10).aspx</a></p>
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_vista">windows_vista, </a> <br>
<a href="/search?q=files,_folders,_&#38;_storage">files,_folders,_&#38;_storage, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>The maximum resolution that XP can support, both 32-bit and or - Microsoft Community</title>
<h3> bolt_lightning  say:</h3>
<h2>            The maximum resolution that XP can support, both 32-bit and or 64-bit&#63;</h2>
                    <p>.....so this continuing from here: https://social.technet.microsoft.com/Forums/en-US/97d515a1-5849-4fc7-92cc-f5c1d89b744c/the-maximum-resolution-that-windows-xp-can-support?forum=Offtopic as I never really got answer to satisfy my question, and was advised
 to post the question here so here goes:</p>
<p>
</p><p>Can anyone here describe the technical limitations of windows XP and it's 64-bit variant on higher resolution displays and their respective refresh rate on various connection types(ie DisplayPort, VGA, etc.,)?</p>
<p>
</p><p>Yeah yeah I know I'm two years late but I never got a notification of that last post to my post and just realized now that it does have a post and now wanna check it out but never got the question answered.....so better late than never I guess!</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Ken  Blake" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display purple526 avatar-size-extrasmall"; this.setAttribute("alt", "KB"); this.style="display: inline-block";'
<h3> ken  blake  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>The resolution limitation of any version of Windows primarily depends on the video card you have installed.</p>
<p>
</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> bolt_lightning  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>
</p><blockquote>
<p>The resolution limitation of any version of Windows primarily depends on the video card you have installed.</p>
<p>
</p></blockquote>
<p>If that's so how come I am unable to run 2560x1440p120 when I can run this on windows 7 with both using the exact same video card and both utilizing the display port connection?<br />
</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Ken  Blake" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display purple526 avatar-size-extrasmall"; this.setAttribute("alt", "KB"); this.style="display: inline-block";'
<h3> ken  blake  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Probably because you don't have correct driver for the video card installed.<br />
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="3" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> bolt_lightning  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>
</p><blockquote>Probably because you don't have correct driver for the video card installed.<br />
</blockquote>
<p>But I do have the correct drivers...otherwise I wouldn't be able to play any games on it......and games definitely need correct drivers for their hardware to work......<br />
</p>
        </p>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_xp">windows_xp, </a> <br>
<a href="/search?q=devices_and_drivers">devices_and_drivers, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>1st Gen Surface Book Can&#39;t Upgrade to Creator&#39;s Update - Microsoft Community</title>
<h3> david holiman  say:</h3>
<h2>            1st Gen Surface Book Can&#39;t Upgrade to Creator&#39;s Update</h2>
                    <p>First-gen Surface Book i7-512GB</p>
<p>
</p><p>Upgrade to version 1703 fails with the attached screenshot. <a href="https://filestore.community.support.microsoft.com/api/images/8765604e-02b0-4a89-8b14-1e58048c0903" target="_blank" rel="noreferrer nofollow">
<img src="https://filestore.community.support.microsoft.com/api/images/8765604e-02b0-4a89-8b14-1e58048c0903" /></a></p>
<p>
</p><p>&nbsp;It powers itself down after a minute and I can turn it back on and return to the prior installation/version as if nothing happened. &nbsp;However, the download/install process for 1703 starts over again. &nbsp;I am, in essence, in a never-ending cyclical reboot.
 &nbsp;</p>
<p>
</p><p>Have tried the following:</p>
<p>- turning BitLocker OFF and decrypting the C: drive</p>
<p>- Boot to "Safe Mode" and delete everything from c:\windows\softwaredistribution\download directory</p>
<p>
</p><p>The update appears to download OK via Windows Update. &nbsp;Hyper-V is set up on this machine but no VMs are set up on it.</p>
<p>
</p><p>The device is out of warranty.</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="PA Bear - MS MVP" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display blue660 avatar-size-extrasmall"; this.setAttribute("alt", "PB"); this.style="display: inline-block";'
<h3> pa bear - ms mvp  say:</h3>
<ul class="message-user-info-affiliations-list">
    </ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            The&nbsp;0xc00000f error very strongly suggests a failing (or about-to-fail)&nbsp;HDD.
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="David Holiman" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display lime362 avatar-size-extrasmall"; this.setAttribute("alt", "DH"); this.style="display: inline-block";'
<h3> david holiman  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<p>
</p><blockquote>The&nbsp;0xc00000f error very strongly suggests a failing (or about-to-fail)&nbsp;HDD.
</blockquote>
<p>Hmm...bummer, then. &nbsp;I was able to push the upgrade through by downloading the ISO, mounting it as a DVD drive, copy everything to a separate folder on my desktop, and running Setup from there, doing an in-place upgrade. &nbsp;No issues during that process so
 who knows what might have been going on. &nbsp;We'll see if the SSD keeps on churning or not! &nbsp;Thanks for responding.</p>
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="PA Bear - MS MVP" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display blue660 avatar-size-extrasmall"; this.setAttribute("alt", "PB"); this.style="display: inline-block";'
<h3> pa bear - ms mvp  say:</h3>
<ul class="message-user-info-affiliations-list">
    </ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            
<div style="text-align: justify">Good luck on the 9th!</div>
        </p>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=windows_update,_recovery,_&#38;_backup">windows_update,_recovery,_&#38;_backup, </a> <br>
<a href="/search?q=pc">pc, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Results in Windows - Microsoft Community</title>
                        <span><a id="toggleFilterVisibility" role="button" class="c-hyperlink" tabindex="0">Show filters</a></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
<br><br>------------------------------------<br>
    <title>Touchpad works on login screen, won&#39;t work afterwards. - Microsoft Community</title>
<h3> jerimigalligory  say:</h3>
<h2>            Touchpad works on login screen, won&#39;t work afterwards.</h2>
                    I have an Acer laptop with a touchpad. The touchpad used to work fine, but now it only works on the login screen, where I select the user. When I go to the Device Settings on Mouse Properties, it tells me that the mouse is disabled, however, when I go
 to enable it, it is already enabled.&nbsp;
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall" title="Inactive profile" role="img">
<h3> a. user  say:</h3>
<ul class="message-user-info-affiliations-list">
</ul>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Hi Jerimi,</p>
<p>
</p><p>This issue may be due to an outdated mouse driver, we suggest that you follow the steps provided
<a href="https://support.microsoft.com/en-us/instantanswers/ad5a063e-5f57-c715-2566-b983195752c1/update-drivers-in-windows-10" target="_blank" rel="noreferrer nofollow">
here</a> to upgrade your device.</p>
<p>
</p><p>Get back to us with the result.</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> jerimigalligory  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            I followed these steps, my driver is up-to-date, but the touchpad still doesn't work.
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall" title="Inactive profile" role="img">
<h3> a. user  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Hi Jerimi,</p>
<p>
</p><p>
</p><p>To better assist you with your concern, we would like to ask what changes did you make before the issue started?</p>
<p>
</p><p>We look forward to your reply.</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="3" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> jerimigalligory  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            I did not make any changes I can think of, I just used the computer normally.
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="4" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall" title="Inactive profile" role="img">
<h3> a. user  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Jerimi, we would recommend that you boot your computer in safe mode. <span>&nbsp;</span>Booting your computer in safe mode starts Windows in a basic state, using a limited set of files and drivers. It can help you troubleshoot problems on your PC. For example,
 if the problem doesn't happen in safe mode, you'll know default settings and basic device drivers aren't causing the issue. For more information about safe mode, you can check the article below.</p>
<p>&nbsp;</p>
<p><a href="https://support.microsoft.com/en-us/help/12376/windows-10-start-your-pc-in-safe-mode" target="_blank" rel="noreferrer nofollow">Start your PC in safe mode in Windows 10</a></p>
<p>&nbsp;</p>
<p>Let us know how it goes.</p>
        </p>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=devices_&#38;_drivers">devices_&#38;_drivers, </a> <br>
<a href="/search?q=pc">pc, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Can&#39;t Unistall a partially installed App - Microsoft Community</title>
<h3> bkennerley  say:</h3>
<h2>            Can&#39;t Unistall a partially installed App</h2>
                    I recently tried to install a new app on to my laptop running Windows 10, but for some reason the installation failed. To retry the installation the installer is telling me to remove the partially installed app via the Control Panel (System). I can find
 the App in the System search but when I click on "Uninstall" nothing happens. Is there an alternate way of uninstalling the partial installation?
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall" title="Inactive profile" role="img">
<h3> a. user  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p><span>Hi,</span></p>
<p>
</p><p><span>Thank you for your interest in Windows 10.</span></p>
<p>
</p><ol>
<li>
<p style="color: rgba(0, 0, 0, 1)">What is the name of the app you are trying to install?</p>
</li><li>
<p style="color: rgba(0, 0, 0, 1)">Where are you trying to install it from? Is it from Windows Store?</p>
</li></ol>
<p><span>If it is program which you are trying to uninstall, I suggest you to follow the article below and run the Fixit:</span></p>
<p><a href="https://support.microsoft.com/en-us/mats/program_install_and_uninstall?wa=wsignin1.0" target="_blank" rel="noreferrer nofollow"><span style="color: rgba(5, 99, 193, 1)">https://support.microsoft.com/en-us/mats/program_install_and_uninstall?wa=wsignin1.0</span></a></p>
<p>
</p><p><span><span>Your question does not contain all the required information needed for us to help you. I suggest you to provide more details regarding the issue you’re facing, we’ll be glad to assist you.</span></span></p>
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> bkennerley  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>The program I had started to install is "E-Designer 7" by Biejer.&nbsp; This is a program for Creating and Editing HMI screens.</p>
<p>
</p><p>I was trying to install it via&nbsp;the manufacturers&nbsp;program files&nbsp;downloaded on to my lap top.</p>
<p>
</p><p>I tried the link to "Fixit", but it&nbsp;is not supported by Windows 10.</p>
<p>
</p><p>If you can tell me how to remove the Program from the "System, Apps and Features" listing then I can try a full install again. But as I mentioned earlier, when I&nbsp; try to click on "Uninstall" nothing happens.</p>
<p>
</p><p>
</p><p />
        </p>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=windows_settings">windows_settings, </a> <br>
<a href="/search?q=pc">pc, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Windows 10 - Imported Photos NOT in Pictures Folder&#63; - Microsoft Community</title>
<h3> art in gp  say:</h3>
<h2>            Windows 10 - Imported Photos NOT in Pictures Folder&#63;</h2>
                    <p>Wife ran WIN 10 upgrade and is now on warpath over all the changes..</p>
<p>
</p><p>Plugs in camera to USB, now some "Photos" app comes up, and she can no longer import photos to a folder named based on the date of import.&nbsp; Clicking IMPORT appears to pull pix off the camera, but they are not in the user/%username%/Pictures folder.&nbsp; They
 appear in the app, but can't find them using File Manager.&nbsp;&nbsp; </p>
<p>
</p><p>First question.... Where does it put them?&nbsp; (don't say users/username/pictures.... they ain't there, and no other paths&nbsp;appear in any settings choices...)</p>
<p>
</p><p>Next question....&nbsp; How do you STOP win 10 from launching that Photos App when the camera comes on, and just have it prompt you where to import files&nbsp;to, just as it used to???&nbsp;&nbsp; Changing the Autoplay settings has ZERO effect on what happens....&nbsp; tell it to
 "do nothing", and it still launches that Photos App when it sees the camera.&nbsp; Any setting in Autoplay has the same effect... NOTHING.</p>
<p>
</p><p>Appreciate any help....&nbsp; </p>
<p>Art</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<!--InFlight-->
<div id="allReplies">
        <div id="pagerTop" class="pager-container clearBoth">
            <div id="pagerTopDesktop">
<meta name="awa-prevPage" content="1" />
<div>
            </span>
                        <span>
    
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Mr Wilson_13" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display blue660 avatar-size-extrasmall"; this.setAttribute("alt", "MW"); this.style="display: inline-block";'
<h3> mr wilson_13  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            check in photo app folder if not&nbsp;<span style="color: rgba(51, 51, 51, 1)">users/username/pictures</span>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> art in gp  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            Where might that be located?&nbsp;&nbsp; My guess is subfolder of "Windows Apps", under Program Files?&nbsp;&nbsp; Access Denied.&nbsp; Win 10 trying to protect me from myself.&nbsp;&nbsp;&nbsp;&nbsp; Or is it somewhere else?
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="2" msgsection="Replies"
     translated-to=""
     translated-from="">
            
        <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall circular-display" role="img"
           title="Keith A. Miller" aria-label="Profile picture" >
            <img onerror='this.className="default-avatar-profile circular-display purple526 avatar-size-extrasmall"; this.setAttribute("alt", "KA"); this.style="display: inline-block";'
<h3> keith a. miller  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Typing "autoplay" into the search bar shows both Modern Settings and Control Panel options.&nbsp; Have you checked settings in both locations?&nbsp; Have you checked the 'Pictures' folder on OneDrive to see if the photos were placed there?</p>
<p>
</p><p>Keith</p>
<p />
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="3" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall" title="Inactive profile" role="img">
<h3> a. user  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Firstly, the Photos app sorts pictures in date blocks as they were taken, so no need to put into separate folders physically, although you can do so through the app itself if you so desire.</p>
<p>
</p><p>Secondly, if you click on the Settings icon (the gear wheel) at the bottom left, it will tell you the sources that the app uses to collate pictures.</p>
<p>
</p><p>Thirdly, if you take a little time to learn the app, you may well find that it's functionality is better than what you've been using before...</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="4" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> art in gp  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Hi Keith...</p>
<p>That's one of the issues....&nbsp; changing the "autoplay" settings is having no affect at all on what happens when the camera is attached.&nbsp;&nbsp; Whether I tell it to open File Manager, or to "do nothing", or open a different application for handling pictures, it&nbsp;changes&nbsp;nothing
 (even with log off/on and reboots), and plugging in the camera will launch "Photos" app regardless of the setting.&nbsp;&nbsp; THAT is the main problem.</p>
<p>
</p><p>One Drive isn't set up on the computer, so I don't think it would put them there.&nbsp; At least... it had better not!</p>
<p>
</p><p>Thanks!</p>
<p>Art</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="5" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> art in gp  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Gordon...</p>
<p>
</p><p>I despise "apps" that behave like this....&nbsp; its all very MAC-like.&nbsp;&nbsp; It does what it thinks I&nbsp;<em><strong>should</strong></em>&nbsp;want, and its wrong!&nbsp; In fact, I don't even want to SEE the app.&nbsp;&nbsp;&nbsp;If I was a complete idiot and could not comprehend that pictures
 are files and files can be placed and labeled however and wherever I want, then this app would be ok.</p>
<p>
</p><p>Ideally I want the functionality that appears lost.....&nbsp; plug in the camera, and it imports to wherever I TELL IT TO and tags the file names or
<em><strong>destination</strong></em> <em>folders</em>.&nbsp; </p>
<p>
</p><p>And&nbsp;if that functionality no longer exists, then I want to choose some other action from the autoplay settings, and I want that action to WORK.</p>
<p>
</p><p>Any ideas on how to get autoplay settings to work?</p>
<p>
</p><p>Thanks!</p>
<p>Art</p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="6" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> neilpzz  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Have you checked this autoplay setting. There are two options here</p>
<p><img src="https://filestore.community.support.microsoft.com/api/images/92c9ec5c-aa26-4e4a-b8a5-8920f825d4dd" /></p>
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="7" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link avatar-size-extrasmall" title="Inactive profile" role="img">
<h3> a. user  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Try this:</p>
<p>In the search bar type in <strong>default programs</strong></p>
<p>Open the Default programs link.</p>
<p>Click on "Set your Default Programs"</p>
<p>Click on "Photos" in the L/H pane.</p>
<p>Remove all the defaults. (I think you'll have to uncheck them all individually).</p>
<p>
</p><p>See if that helps.</p>
<p />
        </p>
<div  class="thread-message thread-message-enus"
     pagepos="1" msgpos="8" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> harferdaily  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Hi,</p>
<p>Had the same problem in importing pictures from SD Card to folder just went straight to App.</p>
<p>Selected Settings, clicked Devices, clicked autoplay, selected SD Card and import using Windows Live pictures. Inserted SD again and this time Windows Live came up, aske me to name the file and imported.</p>
<p />
        </p>
<div id="LastReply" class="thread-message thread-message-enus"
     pagepos="1" msgpos="9" msgsection="Replies"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-extrasmall" role="img"
<h3> art in gp  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            <p>Neilpzz....&nbsp;&nbsp;&nbsp; Yes... that setting appears to make no difference at all in what happens when the camera is plugged into the computer.&nbsp; It always opens the Photos app, regardless of the setting I enter there, even after reboots.</p>
<p>
</p><p>Art</p>
        </p>
    <div id="pagerBottom" class="pager-container clearBoth">
        <div id="pagerBottomDesktop">
<meta name="awa-prevPage" content="1" />
<div>
            </span>
                        <span>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=files,_folders,_&#38;_storage">files,_folders,_&#38;_storage, </a> <br>
<a href="/search?q=pc">pc, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
    <title>Empty Trash and Junk Folder in Windows 10 Mail app with a single click - Microsoft Community</title>
<h3> ajainvu  say:</h3>
<h2>            Empty Trash and Junk Folder in Windows 10 Mail app with a single click</h2>
                    <p>Hi,</p>
<p>
</p><p>Is there an option in Windows 10 Mail app which allows me empty the trash and junk folders in my email with a single click?</p>
<p>
</p><p>I already know that I can enter the selection mode and manually select each mail in a folder and delete them altogether, but that is not what I am looking for. Although an option to select all the messages in a folder either by Ctrl+A or a Select All button
 would be great improvement and should be considered for future updates to the mail app.</p>
                </div>


            <div role="alert" class="m-alert f-information">
</button>
</span>
            <div id="threadBottomSection" class="">
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="0" msgsection="Answers"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-small" role="img"
<h3> puttnutt  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            you can select a deleted message and hold down the "keyboard" delete button and the messages will rapidly delete
        </p>
<div  class="thread-message thread-message-answer shading thread-message-enus"
     pagepos="1" msgpos="1" msgsection="Answers"
     translated-to=""
     translated-from="">
            
            <div data-bi-id="message-username-image-link" class="message-user-image message-username-image-link circular-display avatar-size-small" role="img"
<h3> bantonman  say:</h3>
            </span>
            <!-- MessageHistoryPanel.cshtml loaded via ajax -->
            
            That's not the answer to the question asked. That method means ticking each email one by one and then hitting the delete option. A very long winded method that isn't the answer. The OP already stated this &lt;content removed&gt;<br />
How to delete ALL mails in a particular folder.<br />
<br />
Simply select one of the emails as if you wish to read it.<br />
<br />
Press and hold the DELETE key. A moment after the first deletes, the rest will rapidly delete.<br />
&nbsp;
        </p>
<div id="allRepliesLink" aria-expanded="false">
            <h2 role="presentation">
        </h2>
<a href="/search?q=windows">windows, </a> <br>
<a href="/search?q=windows_10">windows_10, </a> <br>
<a href="/search?q=apps">apps, </a> <br>
<a href="/search?q=mail&#47;outlook_mail">mail&#47;outlook_mail, </a> <br>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
<br><br>------------------------------------<br>
